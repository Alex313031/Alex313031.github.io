{"version":3,"sources":["../../node_modules/browser-pack/_prelude.js","../../node_modules/process/browser.js","../../node_modules/tween.js/src/Tween.js","js/CannonController.js","js/Joint.js","js/JointMaterial.js","js/JointTexture.js","js/LaserOimoWrapper.js","js/getCustomDepthMaterial.js","js/main.js","js/randomElement.js","js/skinDataToGeometry.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACpLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACt2BA;;AAEA;;AAEA,IAAI,mBAAmB,SAAnB,gBAAmB,CAAS,OAAT,EAAiB;;AAEtC,YAAU,WAAW,EAArB;;AAEA,MAAI,gBAAgB,QAAQ,aAAR,IAA0B,IAAI,EAAlD,CAJsC,CAIgB;AACtD,MAAI,cAAc,QAAQ,WAAR,IAAwB,CAA1C;;AAEA,MAAI,QAAQ,IAAI,OAAO,KAAX,EAAZ;;AAEA,QAAM,UAAN,GAAmB,IAAI,OAAO,eAAX,EAAnB;;AAEA,QAAM,OAAN,GAAgB,QAAQ,OAAR,IAAoB,IAAI,OAAO,IAAX,CAAgB,CAAhB,EAAmB,CAAC,GAApB,EAAyB,CAAzB,CAApC,CAXsC,CAW2B;;AAEjE,MAAI,SAAS,MAAM,MAAnB;;AAEA,MAAI,QAAJ;;AAEA,MAAI,KAAK,SAAL,EAAK,CAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe;AAAE,QAAI,OAAO,IAAX,CAAgB,CAAhB,EAAkB,CAAlB,EAAoB,CAApB;AAAyB,GAAnD;;AAEA,WAAS,MAAT,CAAiB,IAAjB,EAAuB;;AAErB,QAAG,aAAa,SAAhB,EAA0B;;AAEvB,YAAM,IAAN,CAAY,aAAZ,EAA2B,OAAO,QAAlC,EAA4C,WAA5C;AAEF;;AAED,eAAW,IAAX;AAED;;AAED,WAAS,OAAT,CAAkB,KAAlB,EAAyB,MAAzB,EAAiC;;AAE/B,QAAI,OAAO,IAAI,OAAO,IAAX,CAAiB,MAAjB,CAAX;;AAEA,SAAK,QAAL,CAAe,KAAf;;AAEA,UAAM,GAAN,CAAW,IAAX;;AAEA,WAAO,IAAP;AACD;;AAED,WAAS,UAAT,CAAqB,IAArB,EAA2B;;AAEzB,UAAM,UAAN,CAAkB,IAAlB;AAED;;AAED,WAAS,gBAAT,CAA2B,UAA3B,EAAuC;AACrC,UAAM,gBAAN,CAAuB,UAAvB;AACD;;AAGD,WAAS,aAAT,CAAwB,UAAxB,EAAoC;;AAElC,UAAM,aAAN,CAAqB,UAArB;;AAEA,WAAO,UAAP;AACD;;AAGD,WAAS,kBAAT,CAA6B,KAA7B,EAAoC,WAApC,EAAiD,KAAjD,EAAwD,WAAxD,EAAqE,gBAArE,EAAuF,OAAvF,EAAgG;;AAE9F,QAAI,aAAa,IAAI,OAAO,sBAAX,CACf,KADe,EAEf,WAFe,EAGf,KAHe,EAIf,WAJe,CAAjB;;AAMA,eAAW,gBAAX,GAA8B,qBAAqB,SAArB,GAAgC,gBAAhC,GAAmD,KAAjF;;AAEA,WAAO,cAAe,UAAf,CAAP;AACD;;AAED,WAAS,kBAAT,CAA6B,KAA7B,EAAoC,MAApC,EAA4C,KAA5C,EAAmD,KAAnD,EAA0D,MAA1D,EAAkE,KAAlE,EAAyE,QAAzE,EAAmF,gBAAnF,EAAqG,WAArG,EACA;AACE,QAAI,aAAa,IAAI,OAAO,eAAX,CAA4B,KAA5B,EAAmC,KAAnC,EAA0C;AACzD,cAAQ,MADiD;AAEzD,cAAQ,MAFiD;AAGzD,aAAO,KAHkD,EAG3C;AACd,aAAO,KAJkD,EAI3C;AACd,gBAAU;AAL+C,KAA1C,CAAjB;;AAQA,eAAW,gBAAX,GAA8B,qBAAqB,SAArB,GAAgC,gBAAhC,GAAmD,KAAjF;;AAEA,QAAG,gBAAgB,IAAnB,EAA0B,WAAW,WAAX;;AAE1B,WAAO,cAAe,UAAf,CAAP;AACD;;AAED,WAAS,iBAAT,CAA4B,KAA5B,EAAmC,MAAnC,EAA2C,KAA3C,EAAkD,KAAlD,EAAyD,MAAzD,EAAiE,KAAjE,EAAwE,QAAxE,EAAkF,UAAlF,EAA8F,gBAA9F,EAAgH;;AAE9G,QAAI,aAAa,IAAI,OAAO,mBAAX,CAAgC,KAAhC,EAAuC,KAAvC,EAA8C;AAC3D,cAAQ,MADmD;AAE3D,cAAQ,MAFmD;AAG3D,aAAO,KAHoD;AAI3D,aAAO,KAJoD;AAK3D,gBAAU,YAAY;AALqC,KAA9C,CAAjB;;AASA,eAAW,UAAX,GAAwB,cAAc,CAAtC;;AAEA,eAAW,gBAAX,GAA8B,qBAAqB,SAArB,GAAgC,gBAAhC,GAAmD,KAAjF;;AAEA,WAAO,cAAe,UAAf,CAAP;AACD;;AAED,WAAS,iBAAT,CAA4B,KAA5B,EAAmC,KAAnC,EAA0C,QAA1C,EAAoD,gBAApD,EAAsE;AACpE,QAAI,aAAa,IAAI,OAAO,cAAX,CAA4B,KAA5B,EAAmC,KAAnC,EAA0C;AACzD,gBAAU;AAD+C,KAA1C,CAAjB;;AAIA,eAAW,gBAAX,GAA8B,qBAAqB,SAArB,GAAgC,gBAAhC,GAAmD,KAAjF;;AAEA,WAAO,cAAe,UAAf,CAAP;AACD;;AAED,WAAS,SAAT,CAAoB,MAApB,EAA4B,OAA5B,EAAqC;;AAEnC,QAAI,cAAc,IAAI,OAAO,MAAX,CAAmB,MAAnB,CAAlB;;AAEA,WAAO,QAAS,WAAT,EAAsB,OAAtB,CAAP;AACD;;AAED,WAAS,MAAT,CAAiB,WAAjB,EAA8B,OAA9B,EAAuC;;AAErC,QAAI,MAAM,IAAI,OAAO,GAAX,CAAgB,eAAe,GAAI,GAAJ,EAAS,GAAT,EAAc,GAAd,CAA/B,CAAV;;AAEA,WAAO,QAAS,GAAT,EAAc,OAAd,CAAP;AACD;;AAED,WAAS,QAAT,CAAmB,OAAnB,EAA4B;;AAE1B,QAAI,QAAQ,IAAI,OAAO,KAAX,EAAZ;;AAEA,WAAO,QAAS,KAAT,EAAgB,OAAhB,CAAP;AAED;;AAED,SAAO;;AAEL,WAAO,KAFF;;AAIL,aAAS,MAAM,OAJV;;AAML,YAAQ,MANH;;AAQL,YAAQ,MARH;;AAUL,aAAS,OAVJ;;AAYL,gBAAY,UAZP;;AAcL,sBAAkB,gBAdb;;AAgBL,mBAAe,aAhBV;;AAkBL,wBAAoB,kBAlBf;;AAoBL,uBAAmB,iBApBd;;AAsBL,wBAAoB,kBAtBf;;AAwBL,uBAAmB,iBAxBd;;AA0BL,eAAW,SA1BN;;AA4BL,YAAQ,MA5BH;;AA8BL,cAAU,QA9BL;;AAgCL,gBAAY,oBAAU,OAAV,EAAmB,OAAnB,EAA4B;;AAEtC,UAAG,CAAC,QAAQ,QAAR,CAAiB,WAArB,EAAiC;AAC/B,gBAAQ,QAAR,CAAiB,kBAAjB;AACD;;AAED,UAAI,UAAU,QAAQ,QAAR,CAAiB,WAAjB,CAA6B,OAA7B,GAAuC,QAAvC,CAAiD,QAAQ,KAAzD,CAAd;;AAEA,UAAI,cAAc,IAAI,OAAO,IAAX,CAAiB,QAAQ,CAAR,GAAY,GAA7B,EAAkC,QAAQ,CAAR,GAAY,GAA9C,EAAmD,QAAQ,CAAR,GAAY,GAA/D,CAAlB;;AAEA,aAAO,OAAQ,WAAR,EAAqB,OAArB,CAAP;AAED;;AA5CI,GAAP;AAgDD,CA7LD;;AAgMA,OAAO,OAAP,GAAiB,gBAAjB;;;ACpMA;;AAGA,IAAI,QAAQ,SAAR,KAAQ,CAAW,OAAX,EAAqB;;AAE/B,QAAM,QAAN,CAAe,IAAf,CAAqB,IAArB;;AAEA,OAAK,IAAL,GAAY,OAAZ;;AAEA,OAAK,MAAL,GAAc,IAAI,MAAM,OAAV,EAAd;;AAEA,OAAK,SAAL,GAAiB,IAAI,MAAM,OAAV,EAAjB;;AAEA,SAAO,MAAP,CAAc,IAAd,EAAoB,WAAW,EAA/B;;AAEA,OAAK,WAAL,CAAiB,KAAK,SAAtB;;AAEA,OAAK,SAAL;AAED,CAhBD;;AAkBA,MAAM,SAAN,GAAkB,OAAO,MAAP,CAAe,MAAM,QAAN,CAAe,SAA9B,CAAlB;AACA,MAAM,SAAN,CAAgB,WAAhB,GAA8B,KAA9B;;AAEA,MAAM,SAAN,CAAgB,SAAhB,GAA4B,YAAU;;AAEpC,OAAK,iBAAL;;AAEA,OAAK,MAAL,CAAY,UAAZ,CAAwB,KAAK,WAA7B;AAED,CAND;;AAQA,MAAM,SAAN,CAAgB,eAAhB,GAAkC,YAAW;;AAE3C,OAAK,iBAAL;;AAEA,OAAK,SAAL,CAAe,IAAf,CAAqB,KAAK,WAA1B,EAAwC,QAAxC,CAAkD,KAAK,MAAvD;AAED,CAND;;AASA,OAAO,OAAP,GAAiB,KAAjB;;;ACzCA;AACA;;AAEA,IAAI,UAAU,QAAQ,SAAR,CAAd;;AAEA,IAAI,gBAAgB,SAAhB,aAAgB,CAAS,eAAT,EAA0B,OAA1B,EAAmC;;AAErD,YAAU,WAAW,EAArB;;AAEA,MAAI,MAAM;;AAER,iBAAa,IAFL;;AAIR,cAAU,CAJF;;AAMR,eAAW,KANH;;AAQR,eAAW,IARH;;AAUR,gBAAY,IAVJ;;AAYR,UAAM,CAZE;;AAcR,YAAQ,IAdA;;AAgBR;;AAEA;;;AAIA,cAAU,OAAO,MAAP,CAAe,EAAf,EACR,MAAM,WAAN,CAAkB,MADV,EAER,MAAM,WAAN,CAAkB,KAFV,EAGR,MAAM,WAAN,CAAkB,QAHV,EAIR,MAAM,WAAN,CAAkB,WAJV,EAKR,MAAM,WAAN,CAAkB,OALV,EAMR,MAAM,WAAN,CAAkB,SANV,EAOR,MAAM,WAAN,CAAkB,eAPV,EAQR,MAAM,WAAN,CAAkB,GARV,EASR,MAAM,WAAN,CAAkB,MATV,EAUR;AACE,gBAAW,EAAE,OAAO,IAAI,MAAM,KAAV,CAAiB,QAAjB,CAAT,EADb;AAEE,gBAAW,EAAE,OAAO,IAAI,MAAM,KAAV,CAAiB,QAAjB,CAAT,EAFb;AAGE,iBAAW,EAAE,OAAO,EAAT,EAHb;AAIE,cAAQ,EAAC,MAAM,GAAP,EAAY,OAAO,CAAnB,EAJV;AAKE,gBAAU,EAAC,MAAM,GAAP,EAAY,OAAO,IAAI,MAAM,KAAV,CAAgB,QAAhB,CAAnB,EALZ;AAME;AACA,WAAK,EAAC,MAAM,GAAP,EAAY,OAAO,SAAnB,EAPP;AAQE,oBAAc,EAAC,MAAM,GAAP,EAAY,OAAO,SAAnB,EARhB;AASE,uBAAiB,EAAC,MAAM,IAAP,EAAa,OAAO,QAAQ,eAAR,IAA2B,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,EAAtB,CAA/C;AATnB,KAVQ,CAtBF;;AA6CR,kBAAc,CAEd,eAFc,EAId,iBAJc;;AAMd;;;AAGA,iCATc;;AAWd;;AAEE,2BAbY;;AAed;;;AAGA;;AAEA;;AAEA,kCAtBc,EAwBd,8BAxBc,EA0Bd,iCA1Bc,EA4Bd,+BA5Bc,EA8Bd,uBA9Bc,EAgCd,wBAhCc,EAmCd,MAAM,WAAN,CAAkB,QAAlB,CAnCc,EAoCd,MAAM,WAAN,CAAkB,gBAAlB,CApCc,EAqCd,MAAM,WAAN,CAAkB,iBAAlB,CArCc,EAsCd,MAAM,WAAN,CAAkB,6BAAlB,CAtCc,EAuCd,MAAM,WAAN,CAAkB,oBAAlB,CAvCc,EAwCd,MAAM,WAAN,CAAkB,mBAAlB,CAxCc,EAyCd,MAAM,WAAN,CAAkB,yBAAlB,CAzCc,EA0Cd,MAAM,WAAN,CAAkB,sBAAlB,CA1Cc,EA2Cd,MAAM,WAAN,CAAkB,uBAAlB,CA3Cc,EA4Cd,MAAM,WAAN,CAAkB,yBAAlB,CA5Cc,EA6Cd,MAAM,WAAN,CAAkB,6BAAlB,CA7Cc,EA+Cd,eA/Cc,EAiDZ,MAAM,WAAN,CAAkB,WAAlB,CAjDY,EAkDZ,MAAM,WAAN,CAAkB,YAAlB,CAlDY,EAmDZ,MAAM,WAAN,CAAkB,cAAlB,CAnDY,EAqDZ,0DArDY;;AAwDZ;AACA,qCAzDY,EA2DZ,wCA3DY,EA6DZ,yBA7DY,EA+DZ,sFA/DY,EAgEZ,sFAhEY,EAiEZ,sFAjEY,EAkEZ,sFAlEY,EAoEZ,gDApEY,EAsEZ,GAtEY,EAwEZ,sCAxEY;;AA2EZ;AACA,+DA5EY,EA8EZ,MAAM,WAAN,CAAkB,oBAAlB,CA9EY,EA+EZ,MAAM,WAAN,CAAkB,iBAAlB,CA/EY,EAgFZ,MAAM,WAAN,CAAkB,mBAAlB,CAhFY;;AAkFZ;AACA,2DAnFY,EAqFZ,MAAM,WAAN,CAAkB,wBAAlB,CArFY,EAsFZ,MAAM,WAAN,CAAkB,oBAAlB,CAtFY;AAuFZ;AACA;;;AAGA;AACA;AACA,gFA7FY,EA8FZ,+CA9FY,EA+FZ,8CA/FY,EAkGZ,MAAM,WAAN,CAAkB,oBAAlB,CAlGY,EAmGZ,MAAM,WAAN,CAAkB,wBAAlB,CAnGY,EAsGZ,mCAtGY,EAwGZ,2CAxGY,EA0GZ,MAAM,WAAN,CAAkB,eAAlB,CA1GY,EA2GZ,MAAM,WAAN,CAAkB,kBAAlB,CA3GY,EA6Gd,GA7Gc,EA+GZ,IA/GY,CA+GP,IA/GO,CA7CN;;AA8JR,oBAAgB,CACd,eADc,EAGd,iBAHc,EAKd,uBALc,EAMd,wBANc,EAOd,wBAPc,EAQd,0BARc,EASd,wBATc,EAWd,wBAXc,EAYd,wBAZc,EAcd,MAAM,WAAN,CAAkB,QAAlB,CAdc,EAed,MAAM,WAAN,CAAkB,SAAlB,CAfc,EAgBd,MAAM,WAAN,CAAkB,qBAAlB,CAhBc,EAiBd,MAAM,WAAN,CAAkB,kBAAlB,CAjBc,EAkBd,MAAM,WAAN,CAAkB,mBAAlB,CAlBc,EAmBd,MAAM,WAAN,CAAkB,mBAAlB,CAnBc,EAoBd,MAAM,WAAN,CAAkB,wBAAlB,CApBc,EAqBd,MAAM,WAAN,CAAkB,qBAAlB,CArBc,EAsBd,MAAM,WAAN,CAAkB,wBAAlB,CAtBc,EAuBd,MAAM,WAAN,CAAkB,2BAAlB,CAvBc,EAwBd,MAAM,WAAN,CAAkB,sBAAlB,CAxBc,EAyBd,MAAM,WAAN,CAAkB,mBAAlB,CAzBc,EA0Bd,MAAM,WAAN,CAAkB,OAAlB,CA1Bc,EA2Bd,MAAM,WAAN,CAAkB,aAAlB,CA3Bc,EA4Bd,MAAM,WAAN,CAAkB,4BAAlB,CA5Bc,EA6Bd,MAAM,WAAN,CAAkB,yBAAlB,CA7Bc,EA8Bd,MAAM,WAAN,CAAkB,uBAAlB,CA9Bc,EA+Bd,MAAM,WAAN,CAAkB,yBAAlB,CA/Bc,EAgCd,MAAM,WAAN,CAAkB,2BAAlB,CAhCc,EAiCd,MAAM,WAAN,CAAkB,2BAAlB,CAjCc,EAkCd,MAAM,WAAN,CAAkB,+BAAlB,CAlCc,EAoCd,eApCc,EAsCZ,0CAtCY,EAwCZ,MAAM,WAAN,CAAkB,0BAAlB,CAxCY,EA0CZ,+CA1CY,EA2CZ,uGA3CY,EA4CZ,wCA5CY,EA8CZ,MAAM,WAAN,CAAkB,sBAAlB,CA9CY,EA+CZ,MAAM,WAAN,CAAkB,cAAlB,CA/CY,EAgDZ,MAAM,WAAN,CAAkB,gBAAlB,CAhDY,EAiDZ,MAAM,WAAN,CAAkB,mBAAlB,CAjDY,EAkDZ,MAAM,WAAN,CAAkB,oBAAlB,CAlDY,EAmDZ,MAAM,WAAN,CAAkB,sBAAlB,CAnDY,EAoDZ,MAAM,WAAN,CAAkB,aAAlB,CApDY,EAqDZ,MAAM,WAAN,CAAkB,iBAAlB,CArDY,EAsDZ,MAAM,WAAN,CAAkB,sBAAlB,CAtDY;;AAwDZ;AACA,UAAM,WAAN,CAAkB,uBAAlB,CAzDY,EA0DZ,MAAM,WAAN,CAAkB,iBAAlB,CA1DY;;AA4DZ;AACA,UAAM,WAAN,CAAkB,gBAAlB,CA7DY,EA+DZ,+KA/DY,EAiEZ,MAAM,WAAN,CAAkB,iBAAlB,CAjEY,EAmEZ,uDAnEY,EAqEZ,MAAM,WAAN,CAAkB,8BAAlB,CArEY,EAsEZ,MAAM,WAAN,CAAkB,sBAAlB,CAtEY,EAuEZ,MAAM,WAAN,CAAkB,oBAAlB,CAvEY,EAwEZ,MAAM,WAAN,CAAkB,cAAlB,CAxEY,EA0EZ,yEA1EY,EA4Ed,GA5Ec,EA6Ed,IA7Ec,CA6ER,IA7EQ;;AA9JR,GAAV;;AAgPA,SAAO,MAAP,CAAc,GAAd,EAAmB,WAAW,EAA9B;;AAEA,QAAM,cAAN,CAAqB,IAArB,CAA0B,IAA1B,EAAgC,GAAhC;;AAEA,OAAK,UAAL,GAAkB,IAAlB;;AAEA,OAAK,WAAL,GAAmB,IAAnB;AAED,CA5PD;;AA+PA;;;AAGA,cAAc,SAAd,GAA0B,OAAO,MAAP,CACtB,MAAM,cAAN,CAAqB,SADC,CAA1B;;AAIA;;;AAGA,OAAO,OAAP,GAAiB,aAAjB;;;;;AC5QA,IAAI,eAAe,SAAf,YAAe,CAAS,eAAT,EAA0B;;AAE3C,OAAK,UAAL,GAAkB,eAAlB;;AAEA,MAAI,IAAI,CAAR,CAJ2C,CAIhC;AACX,MAAI,IAAI,MAAM,IAAN,CAAW,cAAX,CAA0B,gBAAgB,MAA1C,CAAR;;AAEA,OAAK,SAAL,GAAiB,IAAI,YAAJ,CAAiB,IAAI,CAAJ,GAAQ,CAAzB,CAAjB;;AAEA,OAAI,IAAI,IAAE,CAAV,EAAa,IAAE,KAAK,UAAL,CAAgB,MAA/B,EAAuC,GAAvC,EAA4C;AAC1C,SAAK,UAAL,CAAgB,CAAhB,EAAmB,OAAnB,CAA4B,KAAK,SAAjC,EAA4C,IAAI,EAAhD;AACD;;AAED,OAAK,OAAL,GAAe,IAAI,MAAM,WAAV,CAAuB,KAAK,SAA5B,EAAuC,CAAvC,EAA0C,CAA1C,EAA6C,MAAM,UAAnD,EAA+D,MAAM,SAArE,CAAf;;AAEA,OAAK,OAAL,CAAa,SAAb,GAAyB,KAAK,OAAL,CAAa,SAAb,GAAyB,MAAM,aAAxD;AAED,CAjBD;;AAqBA,aAAa,SAAb,CAAuB,WAAvB,GAAqC,YAArC;;AAIA,aAAa,SAAb,CAAuB,MAAvB,GAAgC,YAAU;;AAExC,OAAI,IAAI,IAAE,CAAV,EAAa,IAAE,KAAK,UAAL,CAAgB,MAA/B,EAAuC,GAAvC,EAA4C;;AAE1C,SAAK,UAAL,CAAgB,CAAhB,EAAmB,OAAnB,CAA4B,KAAK,SAAjC,EAA4C,IAAI,EAAhD;AAED;;AAED,OAAK,OAAL,CAAa,WAAb,GAA2B,IAA3B;AAED,CAVD;;AAcA,OAAO,OAAP,GAAiB,YAAjB;;;ACzCA;;AAEA;;AAEA,IAAI,mBAAmB,SAAnB,gBAAmB,CAAU,OAAV,EAAmB;;AAExC,YAAU,WAAW,EAArB;;AAEA,OAAK,MAAL,GAAc,EAAd;;AAIA;AACA,OAAK,KAAL,GAAa,IAAI,KAAK,KAAT,CAAgB,QAAQ,QAAR,IAAoB,IAAE,EAAtC,EAA0C,CAA1C,EAA6C,QAAQ,UAAR,IAAsB,EAAnE,CAAb;AACA;AACA,OAAK,KAAL,CAAW,UAAX,CAAsB,GAAtB;;AAEA,OAAK,OAAL,GAAe,KAAK,KAAL,CAAW,OAA1B;;AAEA,OAAK,aAAL,GAAqB,CACnB,CADmB,EAChB;AACH,KAFmB,EAEd;AACL,MAHmB,EAGb;AACN,GAJmB,EAIhB;AACH,YALmB,CAKR;AALQ,GAArB;;AAQA,OAAK,WAAL,GAAmB,IAAI,KAAK,IAAT,CAAc,CAAd,EAAgB,CAAhB,EAAkB,CAAlB,CAAnB;;AAIA,OAAI,IAAI,CAAR,IAAa,OAAb,EAAqB;AACnB,SAAK,CAAL,IAAU,QAAQ,CAAR,CAAV;AACD;AAEF,CA/BD;;AAkCA,iBAAiB,SAAjB,CAA2B,MAA3B,GAAoC,YAAU;AAC5C,OAAK,KAAL,CAAW,IAAX;;AAEA;AACD,CAJD;;AAQA,iBAAiB,SAAjB,CAA2B,UAA3B,GAAwC,UAAU,CAAV,EAAa;;AAEnD,OAAK,KAAL,CAAW,eAAX,CAA4B,CAA5B;AAED,CAJD;;AAOA,iBAAiB,SAAjB,CAA2B,UAA3B,GAAwC,UAAS,OAAT,EAAkB;AACxD,MAAI,SAAS,KAAK,aAAL,CAAmB,KAAnB,EAAb;;AAEA,MAAG,QAAQ,OAAR,KAAoB,SAAvB,EAAwC,OAAO,CAAP,IAAY,QAAQ,OAApB;AACxC,MAAG,QAAQ,QAAR,KAAqB,SAAxB,EAAwC,OAAO,CAAP,IAAY,QAAQ,QAApB;AACxC,MAAG,QAAQ,WAAR,KAAwB,SAA3B,EAAwC,OAAO,CAAP,IAAY,QAAQ,WAApB;AACxC,MAAG,QAAQ,SAAR,KAAsB,SAAzB,EAAwC,OAAO,CAAP,IAAY,QAAQ,SAApB;AACxC,MAAG,QAAQ,YAAR,KAAyB,SAA5B,EAAwC,OAAO,CAAP,IAAY,QAAQ,YAApB;;AAExC,SAAO,MAAP;AACD,CAVD;;AAcA,iBAAiB,SAAjB,CAA2B,MAA3B,GAAoC,UAClC,UADkC,EAElC,GAFkC,EAGlC,KAHkC,EAIlC,OAJkC,EAI1B;;AAER,MAAI,SAAS,KAAK,UAAL,CAAgB,OAAhB,CAAb;;AAEA,MAAI,IAAI;AACN,UAAK,KADC;AAEN,UAAK,CAAC,WAAW,CAAZ,EAAc,WAAW,CAAzB,EAA2B,WAAW,CAAtC,CAFC;AAGN,SAAI,CAAC,IAAI,CAAL,EAAO,IAAI,CAAX,EAAa,IAAI,CAAjB,CAHE;AAIN,SAAI,CAAC,MAAM,CAAP,EAAS,MAAM,CAAf,EAAiB,MAAM,CAAvB,CAJE;AAKN,UAAM,QAAQ,IAAR,KAAiB,SAAjB,GAA6B,QAAQ,IAArC,GAA4C,IAL5C;AAMN,YAAQ;AANF,GAAR;;AASA,SAAO,MAAP,CAAc,CAAd,EAAiB,WAAW,EAA5B;;AAEA,SAAO,KAAK,KAAL,CAAW,GAAX,CAAgB,CAAhB,CAAP;AACD,CApBD;;AAsBA,iBAAiB,SAAjB,CAA2B,SAA3B,GAAuC,UACrC,GADqC,EAErC,GAFqC,EAGrC,KAHqC,EAIrC,OAJqC,EAI7B;;AAER,MAAI,SAAS,KAAK,UAAL,CAAgB,OAAhB,CAAb;;AAEA,MAAI,IAAI;AACN,UAAK,QADC;AAEN,UAAK,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,CAFC;AAGN,SAAI,CAAC,IAAI,CAAL,EAAO,IAAI,CAAX,EAAa,IAAI,CAAjB,CAHE;AAIN,SAAI,CAAC,MAAM,CAAP,EAAS,MAAM,CAAf,EAAiB,MAAM,CAAvB,CAJE;AAKN,UAAM,QAAQ,IAAR,KAAiB,SAAjB,GAA6B,QAAQ,IAArC,GAA4C,IAL5C;AAMN,YAAQ;AANF,GAAR;;AASA,SAAO,MAAP,CAAc,CAAd,EAAiB,WAAW,EAA5B;;AAEA,SAAO,KAAK,KAAL,CAAW,GAAX,CAAgB,CAAhB,CAAP;AACD,CApBD;;AAsBA,iBAAiB,SAAjB,CAA2B,WAA3B,GAAyC,UAAS,CAAT,EAAY,IAAZ,EAAkB,OAAlB,EAA2B;;AAElE,MAAG,CAAC,EAAE,QAAF,CAAW,WAAf,EAA2B;AACzB,MAAE,QAAF,CAAW,kBAAX;AACD;;AAED,MAAI,aAAa,EAAE,QAAF,CAAW,WAAX,CAAuB,OAAvB,GAAiC,QAAjC,CAA0C,EAAE,KAA5C,CAAjB;;AAEA,MAAI,CAAJ;;AAEA,MAAG,SAAS,KAAT,IAAkB,SAAS,SAA9B,EAAwC;AACtC,QAAI,KAAK,MAAL,CAAY,UAAZ,EAAwB,EAAE,QAA1B,EAAoC,EAAE,QAAtC,EAAgD,OAAhD,CAAJ;AACD,GAFD,MAGK,IAAI,SAAS,QAAb,EAAuB;AAC1B,QAAI,KAAK,SAAL,CAAgB,WAAW,CAAX,GAAe,GAA/B,EAAoC,EAAE,QAAtC,EAAgD,EAAE,QAAlD,EAA4D,OAA5D,CAAJ;AACD;;AAED,SAAO,CAAP;AAED,CAnBD;;AAqBA,iBAAiB,SAAjB,CAA2B,cAA3B,GAA4C,UAAS,CAAT,EAAY,CAAZ,EAAe,OAAf,EAAuB;;AAEjE;;AAEA,YAAU,WAAW,EAArB;;AAEA,MAAI,KAAK,IAAI,KAAK,WAAT,EAAT;;AAEA,KAAG,KAAH,GAAW,CAAX;;AAEA,KAAG,KAAH,GAAW,CAAX;;AAEA,MAAG,QAAQ,QAAX,EAAsB,GAAG,iBAAH,CAAqB,IAArB,CAA2B,QAAQ,QAAnC,EAA8C,cAA9C,CAA6D,KAAK,SAAlE;;AAEtB,MAAG,QAAQ,QAAX,EAAsB,GAAG,iBAAH,CAAqB,IAArB,CAA2B,QAAQ,QAAnC,EAA8C,cAA9C,CAA6D,KAAK,SAAlE;;AAEtB,MAAG,QAAQ,KAAX,EAAkB,GAAG,UAAH,CAAc,IAAd,CAAmB,QAAQ,KAA3B;;AAElB,MAAG,QAAQ,KAAX,EAAkB,GAAG,UAAH,CAAc,IAAd,CAAmB,QAAQ,KAA3B;;AAElB,KAAG,cAAH,GAAoB,QAAQ,cAAR,IAA0B,KAA9C;;AAEA,SAAO,EAAP;AACD,CAvBD;;AA0BA,iBAAiB,SAAjB,CAA2B,YAA3B,GAA0C,UAAU,CAAV,EAAa,CAAb,EAAgB,OAAhB,EAAyB;;AAEjE,YAAU,WAAW,EAArB;;AAEA,MAAI,KAAK,KAAK,cAAL,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,OAA1B,CAAT;;AAEA,MAAI,QAAQ,IAAI,KAAK,aAAT,CAAwB,EAAxB,EAA4B,QAAQ,GAAR,IAAe,CAA3C,EAA8C,QAAQ,GAAR,IAAe,KAA7D,CAAZ;;AAEA,OAAK,KAAL,CAAW,QAAX,CAAoB,KAApB;;AAEA,SAAO,KAAP;AACD,CAXD;;AAeA,iBAAiB,SAAjB,CAA2B,gBAA3B,GAA8C,UAAU,UAAV,EAAsB;AAClE,OAAK,KAAL,CAAW,WAAX,CAAuB,UAAvB;AACD,CAFD;;AAMA,iBAAiB,SAAjB,CAA2B,UAA3B,GAAwC,UAAU,CAAV,EAAa,CAAb,EAAgB,OAAhB,EAAyB;;AAE/D,YAAU,WAAW,EAArB;;AAEA,MAAI,SAAS,QAAQ,MAArB;AACA,MAAI,QAAQ,QAAQ,KAApB;AACA,MAAI,MAAM,CAAC,QAAQ,GAAR,IAAe,CAAC,EAAjB,IAAuB,KAAK,QAAtC;AACA,MAAI,MAAM,CAAC,QAAQ,GAAR,IAAe,EAAhB,IAAsB,KAAK,QAArC;;AAEA,MAAI,KAAK,KAAK,cAAL,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,OAA1B,CAAT;;AAEA,MAAI,QAAQ,IAAI,KAAK,UAAT,CAAqB,EAArB,EAAyB,GAAzB,EAA8B,GAA9B,CAAZ;;AAEA,MAAG,MAAH,EAAW,MAAM,UAAN,CAAiB,SAAjB,CAA2B,OAAO,CAAP,CAA3B,EAAsC,OAAO,CAAP,CAAtC,EAboD,CAaH;;AAE5D,MAAG,KAAH,EAAU,MAAM,UAAN,CAAiB,QAAjB,CAA0B,MAAM,CAAN,CAA1B,EAAoC,MAAM,CAAN,CAApC;;AAEV,OAAK,KAAL,CAAW,QAAX,CAAoB,KAApB;;AAEA,SAAO,KAAP;AACD,CApBD;;AAwBA,iBAAiB,SAAjB,CAA2B,aAA3B,GAA2C,UAAU,CAAV,EAAa,CAAb,EAAgB,OAAhB,EAAyB;;AAElE,YAAU,WAAW,EAArB;;AAEA,MAAI,SAAS,QAAQ,MAArB;AACA,MAAI,QAAQ,QAAQ,KAApB;AACA,MAAI,MAAM,CAAC,QAAQ,GAAR,IAAe,CAAC,EAAjB,IAAuB,KAAK,QAAtC;AACA,MAAI,MAAM,CAAC,QAAQ,GAAR,IAAe,EAAhB,IAAsB,KAAK,QAArC;;AAEA,MAAI,KAAK,KAAK,cAAL,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,OAA1B,CAAT;;AAEA,MAAI,QAAQ,IAAI,KAAK,aAAT,CAAwB,EAAxB,EAA4B,GAA5B,EAAiC,GAAjC,CAAZ;;AAEA,MAAG,MAAH,EAAW,MAAM,UAAN,CAAiB,SAAjB,CAA2B,OAAO,CAAP,CAA3B,EAAsC,OAAO,CAAP,CAAtC;;AAEX,MAAG,KAAH,EAAU,MAAM,UAAN,CAAiB,QAAjB,CAA0B,MAAM,CAAN,CAA1B,EAAoC,MAAM,CAAN,CAApC;;AAEV,OAAK,KAAL,CAAW,QAAX,CAAoB,KAApB;;AAEA,SAAO,KAAP;AACD,CApBD;;AAuBA,iBAAiB,SAAjB,CAA2B,UAA3B,GAAwC,UAAU,CAAV,EAAa,CAAb,EAAgB,OAAhB,EAAyB;;AAE/D,YAAU,WAAW,EAArB;;AAEA,MAAI,MAAM,CAAC,QAAQ,GAAR,IAAe,CAAC,EAAjB,IAAuB,KAAK,QAAtC;AACA,MAAI,MAAM,CAAC,QAAQ,GAAR,IAAe,EAAhB,IAAsB,KAAK,QAArC;;AAEA,MAAI,KAAK,KAAK,cAAL,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,OAA1B,CAAT;;AAEA,MAAI,QAAQ,IAAI,KAAK,WAAT,CAAsB,EAAtB,EAA0B,GAA1B,EAA+B,GAA/B,CAAZ;;AAEA,OAAK,KAAL,CAAW,QAAX,CAAoB,KAApB;;AAEA,SAAO,KAAP;AACD,CAdD;;AAiBA,iBAAiB,SAAjB,CAA2B,cAA3B,GAA4C,UAAU,CAAV,EAAa,CAAb,EAAgB,OAAhB,EAAyB;;AAEnE,YAAU,WAAW,EAArB;;AAEA,MAAI,MAAM,CAAC,QAAQ,GAAR,IAAe,CAAC,EAAjB,IAAuB,KAAK,QAAtC;AACA,MAAI,MAAM,CAAC,QAAQ,GAAR,IAAe,EAAhB,IAAsB,KAAK,QAArC;;AAEA,MAAI,KAAK,KAAK,cAAL,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,OAA1B,CAAT;;AAEA,MAAI,QAAQ,IAAI,KAAK,cAAT,CAAyB,EAAzB,EAA6B,GAA7B,EAAkC,GAAlC,CAAZ;;AAEA,OAAK,KAAL,CAAW,QAAX,CAAoB,KAApB;;AAEA,SAAO,KAAP;AACD,CAdD;;AAiBA,iBAAiB,SAAjB,CAA2B,SAA3B,GAAuC,UAAU,CAAV,EAAa,CAAb,EAAgB,OAAhB,EAAyB;;AAE9D,YAAU,WAAW,EAArB;;AAEA,MAAI,MAAM,CAAC,QAAQ,GAAR,IAAe,CAAC,EAAjB,IAAuB,KAAK,QAAtC;AACA,MAAI,MAAM,CAAC,QAAQ,GAAR,IAAe,EAAhB,IAAsB,KAAK,QAArC;;AAEA,MAAI,KAAK,KAAK,cAAL,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,OAA1B,CAAT;;AAEA,MAAI,QAAQ,IAAI,KAAK,kBAAT,CAA6B,EAA7B,EAAiC,GAAjC,EAAsC,GAAtC,CAAZ;;AAEA,OAAK,KAAL,CAAW,QAAX,CAAoB,KAApB;;AAEA,SAAO,KAAP;AACD,CAdD;;AAiBA,OAAO,OAAP,GAAiB,gBAAjB;;;;;ACpRA,OAAO,OAAP,GAAiB,UAAC,GAAD,EAAM,eAAN,EAA0B;;AAEzC,SAAO,IAAI,MAAM,cAAV,CAAyB;;AAE5B,kBAAc;;AAEd;;AAEA,kCAJc,EAMd,8BANc,EAQd,iCARc,EAUd,+BAVc,EAYd,eAZc,EAed,iCAfc,EAiBd,wCAjBc,EAmBd,yBAnBc,EAqBd,sFArBc,EAsBd,sFAtBc,EAuBd,sFAvBc,EAwBd,sFAxBc,EA0Bd,gDA1Bc,EA4Bd,GA5Bc,EA8Bd,sCA9Bc,EAgCd,4EAhCc,EAkCd,8DAlCc,EAoCd,GApCc,EAsCZ,IAtCY,CAsCP,IAtCO,CAFc;;AA0C5B,oBAAgB,CAEhB,MAAM,WAAN,CAAkB,QAAlB,CAFgB,EAGhB,MAAM,WAAN,CAAkB,SAAlB,CAHgB,EAIhB,MAAM,WAAN,CAAkB,kBAAlB,CAJgB,EAKhB,MAAM,WAAN,CAAkB,mBAAlB,CALgB,EAMhB,MAAM,WAAN,CAAkB,wBAAlB,CANgB,EAOhB,MAAM,WAAN,CAAkB,2BAAlB,CAPgB,EAQhB,MAAM,WAAN,CAAkB,+BAAlB,CARgB,EAUhB,eAVgB,EAYd,MAAM,WAAN,CAAkB,0BAAlB,CAZc,EAcd,kCAdc,EAgBd,MAAM,WAAN,CAAkB,cAAlB,CAhBc,EAiBd,MAAM,WAAN,CAAkB,mBAAlB,CAjBc,EAkBd,MAAM,WAAN,CAAkB,oBAAlB,CAlBc,EAoBd,MAAM,WAAN,CAAkB,sBAAlB,CApBc,EAsBd,mDAtBc,EAwBhB,GAxBgB,EAyBd,IAzBc,CAyBT,IAzBS,CA1CY;;AAqE5B,cAAU,IAAI;AArEc,GAAzB,CAAP;AAuED,CAzED;;;;ACAA;;AAEA;;;;AAEA;;;;AAEA;;;;AAEA;;;;AAEA;;;;AAEA;;;;AAEA;;;;AAEA;;;;AAEA;;;;;;AAIA,IAAM,WAAW,OAAO,SAAP,CAAiB,QAAjB,CAA0B,IAA1B,CAA+B,OAAO,WAAtC,EAAmD,OAAnD,CAA2D,aAA3D,IAA4E,CAA5E,IAAkF,UAAU,CAAV,EAAa;AAAE,SAAO,EAAE,QAAF,OAAiB,mCAAxB;AAA8D,CAA9E,CAAgF,CAAC,OAAO,QAAP,CAAD,IAAqB,OAAO,gBAA5G,CAAlG;;AAEA,kBAAkB,KAAK,OAAvB,EAAgC,YAAhC,EAA8C,YAAI;AAChD;AACD,CAFD;;AAMA,IAAI,QAAQ,MAAM,IAAN,CAAW,SAAvB;;AAEA,IAAI,SAAS,SAAT,MAAS,CAAS,OAAT,EAAiB;;AAE5B,YAAU,WAAW,EAArB;;AAEA,MAAI,QAAQ,KAAZ;;AAEA,UAAQ,GAAR,CAAa,kBAAb;;AAEA,MAAI,wBAAwB,KAA5B;;AAEA,MAAI,cAAc,CAAlB;;AAEA,MAAI,YAAY,QAAQ,SAAR,IAAqB,EAAE,YAAF,CAArC;;AAEA,MAAI,WAAW,EAAf;;AAEA,MAAI,UAAU,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAd;;AAEA,MAAI,cAAc,KAAlB;;AAEA,MAAI,aAAa,EAAjB;;AAEA,MAAI,aAAa,GAAjB;;AAEA,MAAI,cAAc,CAAlB;;AAEA,MAAI,mBAAmB,WAAvB;;AAEA,MAAI,kBAAkB,UAAtB;;AAEA,MAAI,YAAY,IAAhB;;AAEA,MAAI,aAAa,GAAjB;;AAGA,MAAI,OAAO,IAAI,KAAK,MAAT,CAAiB,CAAjB,EAAqB,QAArB,EAAX;AACA,OAAK,GAAL,CAAU,QAAV,EAAqB,CAArB;;AAGA;AACA,MAAI,QAAQ,IAAI,KAAK,SAAT,CAAmB,CAAnB,EAAsB,KAAK,KAA3B,EAAkC,QAAlC,EAAZ;AACA,QAAM,MAAN,CAAa,KAAb,GAAqB,CAAC,EAAtB;AACA,QAAM,GAAN,CAAU,QAAV,EAAoB,CAAC,IAArB;;AAEA,MAAI,OAAO,IAAI,KAAK,MAAT,CAAgB,CAAhB,EAAmB,EAAnB,EAAuB,GAAvB,EAA4B,OAA5B,CAAoC,IAApC,CAAX;AACA,MAAI,WAAW,IAAI,KAAK,aAAT,CAAuB,IAAvB,EAA6B,GAA7B,EAAkC,OAAlC,CAA0C,IAA1C,CAAf;;AAIA,MAAI,QAAQ,CAAC,IAAD,EAAM,IAAN,EAAW,IAAX,EAAgB,IAAhB,EAAqB,IAArB,EAA0B,IAA1B,EAA+B,IAA/B,EAAoC,IAApC,EAAyC,IAAzC,EAA8C,IAA9C,EAAmD,IAAnD,EAAwD,IAAxD,CAAZ;AACA,MAAI,WAAW,SAAX,QAAW,GAAM;AACnB,aAAS,oBAAT,CAA8B,6BAAc,KAAd,CAA9B,EAAoD,KAApD;AACD,GAFD;;AAKA,MAAI,kBAAkB;AACpB,UAAM,gBAAM,CAAE,CADM;AAEpB,UAAM,gBAAM,CAAE,CAFM;AAGpB,WAAO,iBAAM,CAAE;AAHK,GAAtB;;AAOA,MAAI,OAAO,IAAI,KAAK,SAAT,CAAmB;AAC5B,cAAW,CAAC,EADgB;AAE5B,gBAAa;AACX,gBAAW,IADA;AAEX,eAAU,GAFC;AAGX,iBAAY;AAHD,KAFe;AAO5B,sBAAmB;AACjB,gBAAW,KADM;AAEjB,eAAU,IAFO;AAGjB,iBAAY,GAHK;AAIjB,uBAAkB,GAJD;AAKjB,iBAAY;AALK;AAPS,GAAnB,EAeV,OAfU,CAeF,QAfE,EAgBV,OAhBU,CAgBF,IAhBE,CAAX;;AAmBA,MAAI,WAAW,IAAI,KAAK,IAAT,CAAc,UAAS,IAAT,EAAe,KAAf,EAAsB,IAAtB,EAA2B;AACtD,SAAK,oBAAL,CAA0B,KAA1B,EAAiC,QAAQ,KAAzC,EAAgD,IAAhD;;AAEA,YAAQ,KAAR;AACE,WAAK,IAAL;AACA,WAAK,IAAL;AACA,WAAK,IAAL;AACA,WAAK,IAAL;AACE,wBAAgB,OAAhB;AACA;AACF;AACE,wBAAgB,MAAhB;AACA;AATJ;AAYD,GAfc,EAeZ,CACH,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CADG,EACkB,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CADlB,EAEH,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CAFG,EAEkB,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CAFlB,EAGH,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CAHG,EAGkB,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CAHlB,EAIH,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CAJG,EAIkB,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CAJlB,EAKH,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CALG,EAKkB,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CALlB,EAMH,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CANG,EAMkB,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CANlB,EAOH,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CAPG,EAOkB,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CAPlB,EAQH,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CARG,EAQkB,CAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,CARlB,CAfY,EAwBZ,KAxBY,EAAf;;AA0BA,WAAS,IAAT,GAAgB,IAAhB;AACA,WAAS,OAAT,GAAmB,IAAnB;AACA,WAAS,QAAT,GAAoB,IAApB;AACA,WAAS,WAAT,GAAuB,IAAvB;;AAGA,MAAI,OAAO,IAAI,KAAK,aAAT,CAAuB;AAChC,gBAAa;AACX,iBAAY,CADD;AAEX,gBAAW,IAFA;AAGX,eAAU;AAHC,KADmB;AAMhC,eAAY;AANoB,GAAvB,EAOR,OAPQ,CAOA,IAPA,CAAX;;AASA,MAAI,WAAW,IAAI,KAAK,IAAT,CAAc,UAAS,IAAT,EAAe,IAAf,EAAoB;AAC/C,SAAK,oBAAL,CAA0B,QAAQ,IAAlC,EAAwC,IAAxC,EAA8C,IAA9C;AACA,oBAAgB,MAAhB;AACD,GAHc,EAGZ,CACH,CAAC,KAAD,CADG,EAEH,CAAC,KAAD,CAFG,EAGH,CAAC,KAAD,CAHG,EAIH,CAAC,KAAD,CAJG,EAKH,CAAC,KAAD,CALG,EAMH,CAAC,KAAD,EAAQ,IAAR,CANG,EAOH,CAAC,KAAD,CAPG,EAQH,CAAC,KAAD,EAAQ,IAAR,CARG,EASH,CAAC,KAAD,CATG,EAUH,CAAC,KAAD,EAAQ,IAAR,CAVG,EAWH,CAAC,KAAD,CAXG,EAYH,CAAC,KAAD,EAAQ,IAAR,CAZG,CAHY,EAgBZ,KAhBY,CAgBN,IAhBM,CAAf;;AAkBA,WAAS,IAAT,GAAgB,IAAhB;AACA,WAAS,OAAT,GAAmB,IAAnB;AACA,WAAS,QAAT,GAAoB,IAApB;AACA,WAAS,WAAT,GAAuB,GAAvB;;AAGA;AACA,OAAK,SAAL,CAAe,GAAf,CAAmB,KAAnB,GAA2B,GAA3B;AACA,OAAK,SAAL,CAAe,KAAf,CAAqB,MAArB;;AAIA;AACA,MAAI,KAAK,IAAI,MAAM,KAAV,CAAgB,QAAhB,CAAT;AACA,MAAI,KAAK,IAAI,MAAM,KAAV,CAAgB,QAAhB,CAAT;AACA,MAAI,UAAU,GAAG,KAAH,EAAd;AACA,MAAI,UAAU,GAAG,KAAH,EAAd;;AAEA;AACA,MAAI,OAAO,IAAI,SAAJ,CAAc,SAAd,CAAX,CA/J4B,CA+JQ;;AAEpC,MAAI,WAAW,KAAK,aAAL,EAAf;;AAEA,MAAG,CAAC,QAAJ,EAAc;AACZ,aAAS,SAAT,CAAmB,OAAnB,GAA6B,IAA7B;AACA,aAAS,SAAT,CAAmB,IAAnB,GAA0B,MAAM,gBAAhC;AACD;AACD,WAAS,aAAT,CAAuB,QAAvB,EAAiC,GAAjC;;AAEA,MAAI,QAAQ,IAAI,MAAM,KAAV,EAAZ;;AAEA,MAAI,QAAQ,IAAI,MAAM,KAAV,EAAZ;AACA,QAAM,GAAN,GAAY,IAAI,MAAM,GAAV,CAAe,QAAf,EAAyB,EAAzB,EAA6B,GAA7B,CAAZ;;AAEA,MAAI,SAAS,IAAI,MAAM,iBAAV,CAA4B,EAA5B,EAAgC,KAAK,MAArC,EAA6C,CAA7C,EAAgD,IAAhD,CAAb;AACA,SAAO,QAAP,CAAgB,CAAhB,GAAoB,EAApB;AACA,SAAO,QAAP,CAAgB,CAAhB,GAAoB,EAApB;AACA,SAAO,MAAP,CAAe,IAAI,MAAM,OAAV,CAAkB,OAAO,QAAP,CAAgB,CAAlC,EAAqC,OAAO,QAAP,CAAgB,CAAhB,GAAkB,EAAvD,EAA2D,CAA3D,CAAf;;AAGA,MAAI,WAAW,IAAI,MAAM,aAAV,CAAyB,MAAzB,EAAiC,SAAS,UAA1C,CAAf;AACA;AACA,WAAS,UAAT,GAAsB,IAAtB;AACA,WAAS,YAAT,GAAwB,IAAxB;AACA,WAAS,SAAT,GAAqB,IAArB;AACA,WAAS,aAAT,GAAyB,IAAzB;AACA,WAAS,aAAT,GAAyB,GAAzB;AACA,WAAS,WAAT,GAAuB,GAAvB;AACA,WAAS,WAAT,GAAuB,EAAvB;AACA,WAAS,WAAT,GAAuB,EAAvB;;AAIA,MAAI,WAAW,SAAX,QAAW,GAAM;AACnB,QAAI,OAAO,IAAI,MAAM,SAAV,EAAX;;AAEA,SAAK,UAAL,GAAkB,IAAlB;AACA,SAAK,MAAL,CAAY,OAAZ,CAAoB,KAApB,GAA4B,SAA5B;AACA,SAAK,MAAL,CAAY,OAAZ,CAAoB,MAApB,GAA6B,SAA7B;AACA,SAAK,MAAL,CAAY,MAAZ,CAAmB,IAAnB,GAA0B,GAA1B;AACA,SAAK,MAAL,CAAY,MAAZ,CAAmB,GAAnB,GAAyB,GAAzB;AACA,SAAK,MAAL,CAAY,MAAZ,CAAmB,GAAnB,GAAyB,EAAzB;;AAEA;AACA;;AAEA,WAAO,IAAP;AACD,GAdD;;AAgBA,MAAI,OAAO,UAAX;AACA,OAAK,KAAL,CAAW,GAAX,CAAe,QAAf,EAAyB,cAAzB,CAAyC,IAAzC;AACA,OAAK,QAAL,CAAc,IAAd,CAAmB,OAAO,QAA1B,EAAoC,GAApC;AACA,OAAK,QAAL,CAAc,CAAd,IAAmB,EAAnB;AACA,OAAK,MAAL,CAAY,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAZ;AACA,QAAM,GAAN,CAAU,IAAV;;AAGA,MAAI,OAAO,IAAI,MAAM,eAAV,CAA2B,QAA3B,EAAqC,QAArC,EAA+C,CAA/C,CAAX;AACA,QAAM,GAAN,CAAW,IAAX;;AAIA,MAAI,MAAM,IAAI,MAAM,IAAV,CAAe,IAAI,MAAM,WAAV,CAAsB,EAAtB,EAAyB,EAAzB,EAA4B,EAA5B,CAAf,EAAgD,IAAI,MAAM,iBAAV,CAA4B;AACpF,WAAO,OAD6E;AAEpF,eAAW,IAFyE;AAGpF,UAAM;AAH8E,GAA5B,CAAhD,CAAV;;AAQA,MAAI,KAAK,gCAAiB;AACxB,aAAS,IAAI,OAAO,IAAX,CAAgB,CAAhB,EAAkB,CAAlB,EAAoB,CAApB,CADe;AAExB,iBAAa,WAAW,CAAX,GAAe;AAFJ,GAAjB,CAAT;;AAMA,MAAI,cAAc,IAAI,MAAM,IAAV,CAAe,IAAI,MAAM,cAAV,CAAyB,CAAzB,CAAf,EAA4C,IAAI,MAAM,iBAAV,CAA4B;AACxF,WAAO,KADiF;AAExF,eAAW;AAF6E,GAA5B,CAA5C,CAAlB;AAIA,cAAY,OAAZ,GAAsB,KAAtB;AACA,cAAY,QAAZ,CAAqB,CAArB,GAAyB,GAAzB;AACA,cAAY,IAAZ,GAAmB,GAAG,SAAH,CAAa,CAAb,EAAgB,EAAC,MAAM,CAAP,EAAhB,CAAnB;AACA,QAAM,GAAN,CAAU,WAAV;;AAIA,MAAI,YAAY,IAAI,MAAM,IAAV,CAAe,IAAI,MAAM,aAAV,CAAyB,GAAzB,EAA8B,GAA9B,EAAmC,EAAnC,EAAuC,EAAvC,CAAf,EAA2D,IAAI,MAAM,iBAAV,CAA6B;AACtG,WAAO,SAD+F;AAEtG,eAAW;AAF2F,GAA7B,CAA3D,CAAhB;AAIA,YAAU,OAAV,GAAoB,KAApB;;AAEA,QAAM,GAAN,CAAU,SAAV;;AAKA,MAAI,UAAU,IAAI,MAAM,WAAV,CAAuB,IAAI,UAAJ,CAAe,CAAC,GAAD,EAAK,CAAL,EAAO,GAAP,EAAY,CAAZ,EAAc,GAAd,EAAkB,GAAlB,CAAf,CAAvB,EAA+D,CAA/D,EAAkE,CAAlE,EAAqE,MAAM,SAA3E,CAAd;AACA,MAAI,gBAAgB,SAAhB,aAAgB,GAAI;;AAEtB,QAAI,YAAY,GAAG,OAAH,GAAa,MAAb,CAAoB,GAAG,OAAH,EAApB,CAAhB;;AAEA,SAAI,IAAI,IAAE,CAAV,EAAa,IAAE,UAAU,MAAzB,EAAiC,GAAjC,EAAsC;AACpC,cAAQ,KAAR,CAAc,IAAd,CAAmB,CAAnB,IAAwB,UAAU,CAAV,IAAe,GAAvC;AACD;AACD,YAAQ,WAAR,GAAsB,IAAtB;AACD,GARD;AASA;;AAGA,MAAI,aAAa,IAAI,MAAM,SAAV,EAAjB;AACA,aAAW,eAAX,CAA2B,MAA3B;;AAGA;AACA,MAAI,OAAO,IAAI,MAAM,IAAV,CAAe,IAAI,MAAM,WAAV,CAAsB,CAAtB,EAAwB,CAAxB,EAA0B,CAA1B,CAAf,EAA6C,IAAI,MAAM,iBAAV,CAA4B;AAClF,WAAO,MAD2E;AAElF,eAAW;AAFuE,GAA5B,CAA7C,CAAX;;AAKA,MAAI,YAAY,IAAI,MAAM,IAAV,CAAe,KAAK,QAApB,EAA8B,IAAI,MAAM,iBAAV,CAA6B;AACzE,WAAO,KADkE;AAEzE,eAAW;AAF8D,GAA7B,CAA9B,CAAhB;AAIA,YAAU,KAAV,CAAgB,cAAhB,CAA+B,CAA/B;;AAEA,MAAI,QAAQ,EAAZ;AACA,MAAI,iBAAiB,EAArB;;AAEA,MAAI,aAAa,SAAb,UAAa,CAAC,IAAD,EAAO,QAAP,EAAoB;AACnC,QAAI,OAAO;AACT,eAAS,IAAI,MAAM,QAAV,EADA;AAET,yBAAmB,EAFV;AAGT,mBAAa,EAHJ;AAIT,mBAAa,EAJJ;AAKT,cAAQ,KALC;AAMT,cAAQ,EANC;AAOT,gBAAU,IAPD;AAQT,gBAAU,IARD;AAST,YAAM,IATG;AAUT,oBAAc;AAVL,KAAX;;AAaA,QAAI,UAAU,KAAK,OAAnB;AACA,UAAM,GAAN,CAAU,OAAV;;AAEA;AACA,QAAI,WAAW,EAAf;;AAEA,SAAK,QAAL,EAAe,OAAf,CAAwB,UAAU,CAAV,EAAa;;AAEnC,UAAI,QAAQ,oBAAU;AACpB,cAAM,EAAE,IADY;AAEpB,mBAAW,IAAI,MAAM,OAAV,GAAoB,SAApB,CAA8B,EAAE,WAAF,CAA9B,CAFS;AAGpB,mBAAW,EAAE;AAHO,OAAV,CAAZ;;AAMA,WAAK,MAAL,CAAY,IAAZ,CAAiB,KAAjB;;AAEA,eAAS,EAAE,IAAX,IAAmB,KAAnB;;AAEA;AACA,UAAG,KAAH,EAAW,MAAM,GAAN,CAAU,UAAU,KAAV,EAAV;AACZ,KAdD;;AAiBA;;AArCmC,+BAsC3B,EAtC2B;;AAwCjC,UAAI,OAAO,KAAK,aAAL,EAAoB,EAApB,CAAX;;AAEA,UAAI,IAAI,IAAI,MAAM,QAAV,EAAR;AACA,QAAE,IAAF,GAAS,EAAT;AACA,QAAE,WAAF,CAAc,IAAI,MAAM,OAAV,GAAoB,SAApB,CAA8B,KAAK,WAAL,CAA9B,CAAd;AACA,QAAE,iBAAF,CAAoB,IAApB;AACA,cAAQ,GAAR,CAAY,CAAZ;AACA,WAAK,WAAL,CAAiB,IAAjB,CAAsB,CAAtB;;AAEA,UAAI,MAAM,IAAI,MAAM,OAAV,GAAoB,UAApB,CAA+B,EAAE,WAAjC,CAAV;;AAEA,WAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,CAAD,EAAK;AACvB,iBAAS,CAAT,EAAY,WAAZ,CAAwB,GAAxB;AACA,UAAE,GAAF,CAAM,SAAS,CAAT,CAAN;AACD,OAHD;;AAKA;AACA,UAAI,IAAI,KAAK,KAAL,EAAR;AACA,QAAE,KAAF,CAAQ,QAAR,CAAkB,IAAI,MAAM,OAAV,GAAoB,SAApB,CAA8B,KAAK,SAAL,CAA9B,CAAlB;AACA,QAAE,OAAF,GAAY,KAAZ;AACA,QAAE,GAAF,CAAM,CAAN;;AAGA,QAAE,IAAF,GAAS,GAAG,UAAH,CAAe,CAAf,EAAkB;AACzB,kBAAU,EAAE,QADa;AAEzB,cAAM,KAAK,IAFc;AAGzB,qBAAa,KAAK;AAHO,OAAlB,CAAT;;AAOA,QAAE,IAAF,CAAO,IAAP,GAAc,IAAd;;AAGA,QAAE,IAAF,GAAS,EAAE,IAAX;AACA,WAAK,iBAAL,CAAuB,IAAvB,CAA4B,CAA5B;AA1EiC;;AAsCnC,SAAI,IAAI,EAAR,IAAa,KAAK,aAAL,CAAb,EAAkC;AAAA,YAA1B,EAA0B;AAqCjC;;AAGD;AACA,SAAI,IAAI,CAAR,IAAa,KAAK,aAAL,CAAb,EAAkC;;AAEhC,UAAI,IAAI,KAAK,aAAL,EAAoB,CAApB,CAAR;AACA,UAAI,IAAI,QAAQ,eAAR,CAAwB,EAAE,YAAF,CAAxB,CAAR;AACA,UAAI,KAAI,QAAQ,eAAR,CAAwB,EAAE,YAAF,CAAxB,CAAR;;AAEA,UAAI,QAAQ,KAAK,aAAL,EAAoB,EAAE,YAAF,CAApB,CAAZ;AACA,UAAI,QAAQ,KAAK,aAAL,EAAoB,EAAE,YAAF,CAApB,CAAZ;;AAEA,UAAI,gBAAgB,IAAI,MAAM,OAAV,GAAoB,SAApB,CAA8B,EAAE,WAAF,CAA9B,CAApB;;AAEA;AACA,UAAI,OAAO,IAAI,MAAM,OAAV,GAAoB,UAApB,CAA+B,EAAE,WAAjC,CAAX;AACA,UAAI,OAAO,IAAI,MAAM,OAAV,GAAoB,UAApB,CAA+B,GAAE,WAAjC,CAAX;;AAEA,UAAI,WAAW,cAAc,KAAd,GAAsB,YAAtB,CAAmC,IAAnC,CAAf;AACA,UAAI,WAAW,cAAc,KAAd,GAAsB,YAAtB,CAAmC,IAAnC,CAAf;;AAEA,UAAI,aAAa,GAAG,iBAAH,CAEf,EAAE,IAFa,EAGf,QAHe,EAIf,OAAO,IAAP,CAAY,MAJG,EAMf,GAAE,IANa,EAOf,QAPe,EAQf,OAAO,IAAP,CAAY,MARG,EAUf,QAVe,CAAjB;;AAaA,iBAAW,KAAX,GAAmB,EAAnB;AACA,iBAAW,UAAX,GAAwB,CAAxB;;AAEA,WAAK,WAAL,CAAiB,IAAjB,CAAsB,UAAtB;AACD;;AAGD;AACA,YAAQ,iBAAR,CAA0B,IAA1B;;AAEA,SAAK,MAAL,CAAY,OAAZ,CAAqB,aAAK;AACxB,QAAE,SAAF;AACD,KAFD;;AAKA;AACA,QAAI,kBAAkB,KAAK,MAAL,CAAY,GAAZ,CAAgB,aAAK;AACzC,aAAO,EAAE,SAAT;AACD,KAFqB,CAAtB;;AAKA,QAAI,eAAe,2BAAiB,eAAjB,CAAnB;AACA,QAAI,gBAAgB,4BAAkB,eAAlB,CAApB;;AAEA,kBAAc,QAAd,CAAuB,GAAvB,CAA2B,KAA3B,GAAmC,OAAnC;AACA,kBAAc,QAAd,CAAuB,YAAvB,CAAoC,KAApC,GAA4C,aAAa,OAAzD;AACA,kBAAc,QAAd,CAAuB,eAAvB,CAAuC,KAAvC,CAA6C,GAA7C,CAAkD,aAAa,OAAb,CAAqB,KAArB,CAA2B,KAA7E,EAAoF,aAAa,OAAb,CAAqB,KAArB,CAA2B,MAA/G;;AAGA,QAAI,OAAO,IAAI,MAAM,IAAV,CAAe,QAAf,EAAyB,aAAzB,CAAX;AACA,SAAK,UAAL,GAAkB,IAAlB;AACA,SAAK,aAAL,GAAqB,IAArB;AACA,SAAK,mBAAL,GAA2B,sCAAuB,aAAvB,EAAsC,eAAtC,CAA3B;;AAGA,YAAQ,GAAR,CAAY,IAAZ;AACA,SAAK,QAAL,GAAgB,QAAhB;AACA,SAAK,QAAL,GAAgB,aAAhB;AACA,SAAK,QAAL,GAAgB,aAAhB;AACA,SAAK,IAAL,GAAY,IAAZ;AACA,SAAK,YAAL,GAAoB,YAApB;;AAEA,SAAK,MAAL,GAAc,IAAd;;AAEA,qBAAiB,eAAe,MAAf,CAAsB,KAAK,iBAA3B,CAAjB;;AAEA,WAAO,IAAP;AACD,GA7JD;;AAgKA,aAAW,IAAX,CAAgB,kBAAhB,EAAoC,gBAAQ;;AAE1C,QAAI,WAAW,kCAAmB,IAAnB,CAAf;;AAEA,QAAI,QAAQ,CAAZ;;AAEA,SAAK,IAAI,IAAE,CAAX,EAAc,IAAE,KAAhB,EAAuB,GAAvB,EAA4B;;AAE1B,UAAI,OAAO,WAAW,IAAX,EAAiB,QAAjB,CAAX;AACA,YAAM,IAAN,CAAW,IAAX;AACD;;AAED,UAAM,CAAN,EAAS,iBAAT,GAA6B,GAA7B;AACA,oBAAgB,MAAhB,IAA0B,YAAK;;AAE7B,YAAM,CAAN,EAAS,IAAT,CAAc,QAAd,CAAuB,QAAvB,CAAgC,MAAhC,CAAuC,KAAvC,GAA+C,GAA/C;;AAEA,UAAG,MAAM,CAAN,EAAS,QAAZ,EAAqB;;AAEnB,cAAM,CAAN,EAAS,QAAT,CAAkB,KAAlB;AAED,OAJD,MAIO;;AAEL,cAAM,CAAN,EAAS,QAAT,GAAoB,IAAI,gBAAM,KAAV,CAAgB,MAAM,CAAN,EAAS,IAAT,CAAc,QAAd,CAAuB,QAAvB,CAAgC,MAAhD,EACnB,MADmB,CACZ,gBAAM,MAAN,CAAa,KAAb,CAAmB,GADP,EAEnB,EAFmB,CAEhB,EAAC,OAAO,CAAR,EAFgB,EAEJ,IAFI,EAGnB,KAHmB,EAApB;AAID;AACF,KAfD;;AAiBA,UAAM,CAAN,EAAS,IAAT,CAAc,QAAd,CAAuB,QAAvB,CAAgC,QAAhC,CAAyC,KAAzC,CAA+C,GAA/C,CAAmD,QAAnD,EA9B0C,CA8BoB;AAC9D,UAAM,CAAN,EAAS,iBAAT,GAA6B,GAA7B;AACA,oBAAgB,MAAhB,IAA0B,YAAK;AAC7B,YAAM,CAAN,EAAS,IAAT,CAAc,QAAd,CAAuB,QAAvB,CAAgC,MAAhC,CAAuC,KAAvC,GAA+C,GAA/C;;AAEA,UAAG,MAAM,CAAN,EAAS,QAAZ,EAAqB;;AAEnB,cAAM,CAAN,EAAS,QAAT,CAAkB,KAAlB;AAED,OAJD,MAIO;;AAEL,cAAM,CAAN,EAAS,QAAT,GAAoB,IAAI,gBAAM,KAAV,CAAgB,MAAM,CAAN,EAAS,IAAT,CAAc,QAAd,CAAuB,QAAvB,CAAgC,MAAhD,EACnB,MADmB,CACZ,gBAAM,MAAN,CAAa,KAAb,CAAmB,GADP,EAEnB,EAFmB,CAEhB,EAAC,OAAO,CAAR,EAFgB,EAEJ,GAFI,EAGnB,KAHmB,EAApB;AAID;AACF,KAdD;;AAgBA,UAAM,CAAN,EAAS,IAAT,CAAc,QAAd,CAAuB,QAAvB,CAAgC,QAAhC,CAAyC,KAAzC,CAA+C,GAA/C,CAAmD,QAAnD;AACA,UAAM,CAAN,EAAS,iBAAT,GAA6B,GAA7B;AACA,oBAAgB,OAAhB,IAA2B,YAAK;;AAE9B,YAAM,CAAN,EAAS,IAAT,CAAc,QAAd,CAAuB,QAAvB,CAAgC,MAAhC,CAAuC,KAAvC,GAA+C,CAA/C;;AAEA,UAAG,MAAM,CAAN,EAAS,QAAZ,EAAqB;;AAEnB,cAAM,CAAN,EAAS,QAAT,CAAkB,KAAlB;AAED,OAJD,MAIO;;AAEL,cAAM,CAAN,EAAS,QAAT,GAAoB,IAAI,gBAAM,KAAV,CAAgB,MAAM,CAAN,EAAS,IAAT,CAAc,QAAd,CAAuB,QAAvB,CAAgC,MAAhD,EACnB,MADmB,CACZ,gBAAM,MAAN,CAAa,KAAb,CAAmB,GADP,EAEnB,EAFmB,CAEhB,EAAC,OAAO,CAAR,EAFgB,EAEJ,GAFI,EAGnB,KAHmB,EAApB;AAID;AAGF,KAjBD;AAmBD,GArED;;AAwEA,MAAI,aAAa,SAAb,UAAa,OAAQ;;AAEvB,QAAI,KAAK,MAAT,EAAiB;AAAA;;AAGf,aAAK,YAAL,CAAkB,MAAlB;;AAEA;AACA;AACA;;;AAIA,YAAI,QAAQ,IAAI,MAAM,OAAV,EAAZ;;AAEA,YAAI,SAAS,KAAK,IAAL,CAAU,QAAV,CAAmB,QAAnB,CAA4B,MAA5B,CAAmC,KAAhD;AACA,YAAI,MAAM,MAAM,MAAhB;AACA,aAAK,WAAL,CAAiB,OAAjB,CAAyB,UAAC,CAAD,EAAI,CAAJ,EAAQ;;AAE/B,cAAI,KAAK,KAAK,WAAL,CAAiB,CAAjB,EAAoB,KAA7B;AACA,cAAI,KAAK,KAAK,WAAL,CAAiB,CAAjB,EAAoB,KAA7B;;AAEA,cAAI,cAAc,CAAd,IAAmB,MAAM,CAA7B,EAAgC;AAC9B;AACD;;AAGD,gBAAM,IAAN,CAAW,GAAG,QAAd;AACA,gBAAM,GAAN,CAAU,GAAG,QAAb;;AAEA,gBAAM,SAAN;AACA,gBAAM,cAAN,CAAsB,GAAtB;;AAEA,gBAAM,IAAN,CAAW,GAAG,QAAd,EAAwB,GAAxB;;AAEA,aAAG,QAAH,CAAY,IAAZ,CAAiB,KAAjB;AACD,SAnBD;;AAsBA,aAAK,MAAL,CAAY,OAAZ,CAAqB,aAAK;AACxB,YAAE,eAAF;AACD,SAFD;;AAIA;AACA,aAAK,WAAL,CAAiB,OAAjB,CAA0B,UAAC,CAAD,EAAI,CAAJ,EAAQ;;AAEhC,cAAG,EAAE,IAAL,EAAU;;AAER,cAAE,IAAF,CAAO,QAAP,CAAgB,CAAhB,IAAqB,WAArB;AACA,cAAE,IAAF,CAAO,QAAP,CAAgB,CAAhB,IAAqB,WAArB;AACA,cAAE,IAAF,CAAO,QAAP,CAAgB,CAAhB,IAAqB,WAArB;;AAEA,cAAE,IAAF,CAAO,eAAP,CAAuB,CAAvB,IAA4B,WAA5B;AACA,cAAE,IAAF,CAAO,eAAP,CAAuB,CAAvB,IAA4B,WAA5B;AACA,cAAE,IAAF,CAAO,eAAP,CAAuB,CAAvB,IAA4B,WAA5B;;AAEA,cAAE,IAAF,CAAO,QAAP,CAAgB,CAAhB,IAAqB,EAAE,IAAF,CAAO,QAAP,CAAgB,CAAhB,GAAoB,UAAzC;AACA,cAAE,IAAF,CAAO,QAAP,CAAgB,CAAhB,IAAqB,EAAE,IAAF,CAAO,QAAP,CAAgB,CAAhB,GAAoB,UAAzC;AACA,cAAE,IAAF,CAAO,QAAP,CAAgB,CAAhB,IAAqB,EAAE,IAAF,CAAO,QAAP,CAAgB,CAAhB,GAAoB,UAAzC;;AAEA,cAAE,QAAF,CAAW,IAAX,CAAgB,EAAE,IAAF,CAAO,QAAvB;AACA,cAAE,UAAF,CAAa,IAAb,CAAkB,EAAE,IAAF,CAAO,UAAzB;AACD;AAEF,SApBD;AA1Ce;AA+DhB;;AAED,QAAG,qBAAH,EAA0B,mBAAmB,IAAnB;AAE3B,GArED;;AAuEA,OAAK,MAAL,GAAc,YAAU;;AAEtB,QAAG,KAAK,OAAL,CAAa,KAAb,IAAsB,KAAK,OAAL,CAAa,KAAb,KAAuB,WAAhD,EAA6D;AAC3D,WAAK,OAAL,CAAa,MAAb,GAAsB,IAAtB,CAA2B,YAAW;AACpC,gBAAQ,GAAR,CAAY,uBAAZ;AACA;AACD,OAHD;AAID;;AAED,kBAAc,MAAM,cAAN,EAAd;;AAEA,oBAAM,MAAN;;AAEA;;AAEA,OAAG,MAAH,CAAU,WAAV;;AAEA,aAAS,MAAT;;AAEA,UAAM,OAAN,CAAe,UAAU,IAAV,EAAgB;;AAE7B,iBAAW,IAAX;AAED,KAJD;AAOD,GA1BD;;AA6BA,OAAK,IAAL,GAAY,YAAU;;AAEpB,aAAS,MAAT,CAAgB,KAAhB,EAAuB,MAAvB,EAA+B,IAA/B,EAAqC,IAArC;AAED,GAJD;;AAOA,OAAK,QAAL,GAAgB,YAAU;;AAExB,WAAO,MAAP,GAAgB,KAAK,MAArB;AACA,WAAO,sBAAP;AAED,GALD;;AAQA,MAAI,YAAY,IAAI,MAAM,SAAV,EAAhB;AACA,MAAI,QAAQ,IAAI,MAAM,OAAV,EAAZ;AACA,MAAI,YAAY,KAAhB;AACA,MAAI,UAAU,KAAd;AACA,MAAI,WAAJ,EAAiB,cAAjB;;AAIA,MAAI,UAAU,SAAV,OAAU,IAAK;;AAEjB,gBAAY,IAAZ;;AAEA,QAAG,EAAE,IAAF,KAAW,WAAd,EAA2B;AACzB,YAAM,CAAN,GAAY,EAAE,OAAF,CAAU,CAAV,EAAa,KAAb,GAAqB,OAAO,UAA9B,GAA6C,CAA7C,GAAiD,CAA3D;AACA,YAAM,CAAN,GAAU,EAAI,EAAE,OAAF,CAAU,CAAV,EAAa,KAAb,GAAqB,OAAO,WAAhC,IAAgD,CAAhD,GAAoD,CAA9D;AACD,KAHD,MAGO;AACL,YAAM,CAAN,GAAY,EAAE,KAAF,GAAU,OAAO,UAAnB,GAAkC,CAAlC,GAAsC,CAAhD;AACA,YAAM,CAAN,GAAU,EAAI,EAAE,KAAF,GAAU,OAAO,WAArB,IAAqC,CAArC,GAAyC,CAAnD;AACD;;AAED,cAAU,aAAV,CAAyB,KAAzB,EAAgC,MAAhC;;AAEA,mBAAe,OAAf,CAAwB,UAAU,CAAV,EAAa;AACnC,QAAE,OAAF,GAAY,IAAZ;AACD,KAFD;;AAIA,QAAI,aAAa,UAAU,gBAAV,CAA4B,cAA5B,CAAjB;;AAEA,mBAAe,OAAf,CAAwB,UAAU,CAAV,EAAa;AACnC,QAAE,OAAF,GAAY,KAAZ;AACD,KAFD;;AAIA,QAAG,WAAW,MAAd,EAAqB;;AAEnB,gBAAU,IAAV;;AAEA,UAAG,EAAE,IAAF,KAAW,YAAd,EAA6B,SAAS,OAAT,GAAmB,KAAnB;AAC7B,eAAS,YAAT,GAAwB,KAAxB;;AAEA,UAAI,OAAO,WAAW,CAAX,EAAc,MAAd,CAAqB,IAArB,CAA0B,IAArC;;AAEA,UAAI,IAAI,WAAW,CAAX,EAAc,KAAtB;;AAEA,gBAAU,QAAV,CAAmB,IAAnB,CAAwB,CAAxB;AACA,gBAAU,MAAV,CAAiB,OAAO,QAAxB;;AAEA,kBAAY,QAAZ,CAAqB,IAArB,CAA0B,CAA1B;AACA,kBAAY,IAAZ,CAAiB,QAAjB,CAA0B,IAA1B,CAA+B,YAAY,QAA3C;;AAEA,uBAAiB,GAAG,kBAAH,CACf,WAAW,CAAX,EAAc,MAAd,CAAqB,IADN,EAEf,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAFe,EAGf,YAAY,IAHG,EAIf,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAJe,CAAjB;AAKD;AACF,GA/CD;;AAiDA,MAAI,YAAY,SAAZ,SAAY,IAAK;;AAEnB,QAAG,OAAH,EAAW;AACT,SAAG,gBAAH,CAAoB,cAApB;AACD;;AAED,QAAG,CAAC,SAAS,YAAb,EAA2B;AACzB,eAAS,OAAT,GAAmB,IAAnB;AACA,eAAS,YAAT,GAAwB,IAAxB;AACD;;AAED,gBAAY,KAAZ;;AAEA,cAAU,KAAV;;AAEA,cAAU,OAAV,GAAoB,KAApB;AACD,GAhBD;;AAkBA,MAAI,SAAS,SAAT,MAAS,IAAK;;AAEhB,QAAG,OAAH,EAAW;;AAET,UAAG,EAAE,IAAF,KAAW,WAAd,EAA2B;AACzB,cAAM,CAAN,GAAY,EAAE,OAAF,CAAU,CAAV,EAAa,KAAb,GAAqB,OAAO,UAA9B,GAA6C,CAA7C,GAAiD,CAA3D;AACA,cAAM,CAAN,GAAU,EAAI,EAAE,OAAF,CAAU,CAAV,EAAa,KAAb,GAAqB,OAAO,WAAhC,IAAgD,CAAhD,GAAoD,CAA9D;AACD,OAHD,MAGO;AACL,cAAM,CAAN,GAAY,EAAE,KAAF,GAAU,OAAO,UAAnB,GAAkC,CAAlC,GAAsC,CAAhD;AACA,cAAM,CAAN,GAAU,EAAI,EAAE,KAAF,GAAU,OAAO,WAArB,IAAqC,CAArC,GAAyC,CAAnD;AACD;;AAED,gBAAU,aAAV,CAAyB,KAAzB,EAAgC,MAAhC;;AAEA,gBAAU,OAAV,GAAoB,IAApB;AACA,UAAI,aAAa,UAAU,eAAV,CAA2B,SAA3B,CAAjB;AACA,gBAAU,OAAV,GAAoB,KAApB;;AAGA,UAAG,WAAW,MAAd,EAAqB;;AAEnB,YAAI,IAAI,WAAW,CAAX,EAAc,KAAtB;;AAEA,oBAAY,QAAZ,CAAqB,IAArB,CAA0B,CAA1B;AACA,oBAAY,IAAZ,CAAiB,QAAjB,CAA0B,IAA1B,CAA+B,CAA/B;AACD;AACF;AAEF,GA5BD;;AA+BA,IAAE,MAAF,EAAU,EAAV,CAAa,WAAb,EAA0B,OAA1B;AACA,IAAE,MAAF,EAAU,EAAV,CAAa,SAAb,EAAwB,SAAxB;AACA,IAAE,MAAF,EAAU,EAAV,CAAa,WAAb,EAA0B,MAA1B;;AAEA,YAAU,EAAV,CAAa,YAAb,EAA2B,OAA3B;AACA,YAAU,EAAV,CAAa,UAAb,EAAyB,SAAzB;AACA,YAAU,EAAV,CAAa,WAAb,EAA0B,MAA1B;;AAGA,SAAO;AACL,WAAO,iBAAU;AACf,WAAK,KAAL;AACD;AAHI,GAAP;AAMD,CAtvBD;;AA0vBA,OAAO,MAAP,GAAgB,YAAM;;AAEpB,MAAI,SAAS,IAAI,MAAJ,EAAb;;AAEA,SAAO,KAAP;AAED,CAND;;;;;ACzxBA;;;;;AAKA,OAAO,OAAP,GAAiB,UAAS,GAAT,EAAc;;AAE7B,MAAI,MAAM,OAAN,CAAc,GAAd,CAAJ,EAAwB;;AAEtB,WAAO,IAAI,KAAK,KAAL,CAAW,KAAK,MAAL,KAAgB,IAAI,MAA/B,CAAJ,CAAP;AAED,GAJD,MAIO,IAAI,eAAe,MAAnB,EAA2B;;AAEhC,WAAO,IAAI,YAAY,OAAO,IAAP,CAAY,GAAZ,CAAZ,CAAJ,CAAP;AAED;;AAED,SAAO,GAAP;AACD,CAbD;;;;;ACPA;;;AAGA,OAAO,OAAP,GAAiB,gBAAQ;;AAEvB,MAAI,QAAQ,KAAK,UAAL,EAAiB,OAAjB,CAAZ;AACA,MAAI,IAAI,KAAK,UAAL,EAAiB,UAAjB,CAAR;AACA,MAAI,IAAI,KAAK,UAAL,EAAiB,QAAjB,CAAR;AACA,MAAI,KAAK,KAAK,UAAL,EAAiB,IAAjB,EAAuB,OAAO,IAAP,CAAY,KAAK,UAAL,EAAiB,IAAjB,CAAZ,EAAoC,CAApC,CAAvB,CAAT;AACA,MAAI,KAAK,KAAK,aAAL,CAAT;AACA,MAAI,KAAK,KAAK,aAAL,CAAT;;AAEA,MAAI,YAAY,EAAhB;AACA,MAAI,UAAU,EAAd;AACA,MAAI,MAAM,EAAV;;AAEA,MAAI,eAAe,EAAnB;AACA,MAAI,eAAe,EAAnB;;AAEA,MAAI,SAAS,SAAT,MAAS,IAAK;AAChB,cAAU,IAAV,CAAe,EAAE,CAAF,CAAf,EAAqB,EAAE,CAAF,CAArB,EAA2B,EAAE,CAAF,CAA3B;AACD,GAFD;;AAIA,MAAI,UAAU,SAAV,OAAU,IAAK;AACjB,YAAQ,IAAR,CAAa,EAAE,CAAF,CAAb,EAAmB,EAAE,CAAF,CAAnB,EAAyB,EAAE,CAAF,CAAzB;AACD,GAFD;;AAIA,MAAI,QAAQ,SAAR,KAAQ,KAAM;AAChB,QAAI,IAAJ,CAAS,GAAG,CAAH,CAAT,EAAgB,GAAG,CAAH,CAAhB;AACD,GAFD;;AAIA,MAAI,kBAAkB,SAAlB,eAAkB,KAAM;AAC1B,iBAAa,IAAb,CAAkB,GAAG,CAAH,KAAS,CAA3B,EAA8B,GAAG,CAAH,KAAS,CAAvC,EAA0C,GAAG,CAAH,KAAS,CAAnD;AACD,GAFD;;AAIA,MAAI,kBAAkB,SAAlB,eAAkB,KAAM;AAC1B,iBAAa,IAAb,CAAkB,GAAG,CAAH,KAAS,CAA3B,EAA8B,GAAG,CAAH,KAAS,CAAvC,EAA0C,GAAG,CAAH,KAAS,CAAnD;AACD,GAFD;;AAIA;AACA,MAAI,EAAJ,EAAQ,EAAR,EAAY,EAAZ,EAAgB,CAAhB,EAAmB,CAAnB;AACA,QAAM,OAAN,CAAe,UAAU,CAAV,EAAa;;AAE1B;AACA,QAAI,OAAO,CACX,EAAG,EAAE,CAAF,EAAK,CAAL,CAAH,CADW,EAEX,EAAG,EAAE,CAAF,EAAK,CAAL,CAAH,CAFW,EAGX,EAAG,EAAE,CAAF,EAAK,CAAL,CAAH,CAHW,CAAX;AAKA,SAAI,IAAE,CAAF,EAAK,IAAE,CAAX,EAAc,IAAE,EAAE,CAAF,EAAK,MAArB,EAA6B,KAAK,GAAlC,EAAuC;;AAErC;AACA,aAAQ,EAAG,EAAE,CAAF,EAAK,CAAL,CAAH,CAAR;AACA,aAAQ,EAAG,EAAE,CAAF,EAAK,CAAL,CAAH,CAAR;AACA,aAAQ,EAAG,EAAE,CAAF,EAAK,CAAL,CAAH,CAAR;;AAEA;AACA,cAAQ,KAAK,CAAL,CAAR,EARqC,CAQpB;AACjB,cAAQ,KAAK,CAAL,CAAR,EATqC,CASpB;AACjB,cAAQ,KAAK,CAAL,CAAR,EAVqC,CAUpB;;AAEjB;AACA,YAAO,GAAI,EAAE,CAAF,EAAK,CAAL,CAAJ,CAAP;AACA,YAAO,GAAI,EAAE,CAAF,EAAK,CAAL,CAAJ,CAAP;AACA,YAAO,GAAI,EAAE,CAAF,EAAK,CAAL,CAAJ,CAAP;;AAEA;AACA,sBAAiB,GAAI,EAAE,CAAF,EAAK,CAAL,CAAJ,CAAjB;AACA,sBAAiB,GAAI,EAAE,CAAF,EAAK,CAAL,CAAJ,CAAjB;AACA,sBAAiB,GAAI,EAAE,CAAF,EAAK,CAAL,CAAJ,CAAjB;;AAEA;AACA,sBAAiB,GAAI,EAAE,CAAF,EAAK,CAAL,CAAJ,CAAjB;AACA,sBAAiB,GAAI,EAAE,CAAF,EAAK,CAAL,CAAJ,CAAjB;AACA,sBAAiB,GAAI,EAAE,CAAF,EAAK,CAAL,CAAJ,CAAjB;AAED;AAEF,GArCD;;AAuCA;AACA,MAAI,WAAW,IAAI,MAAM,cAAV,EAAf;;AAEA,WAAS,YAAT,CAAuB,UAAvB,EAAmC,IAAI,MAAM,eAAV,CAA2B,IAAI,YAAJ,CAAiB,SAAjB,CAA3B,EAAwD,CAAxD,CAAnC;AACA,WAAS,YAAT,CAAuB,eAAvB,EAAwC,IAAI,MAAM,eAAV,CAA2B,IAAI,YAAJ,CAAiB,SAAjB,CAA3B,EAAwD,CAAxD,CAAxC;AACA,WAAS,YAAT,CAAuB,QAAvB,EAAiC,IAAI,MAAM,eAAV,CAA2B,IAAI,YAAJ,CAAiB,SAAjB,CAA3B,EAAwD,CAAxD,CAAjC;AACA,WAAS,YAAT,CAAuB,QAAvB,EAAiC,IAAI,MAAM,eAAV,CAA2B,IAAI,YAAJ,CAAiB,OAAjB,CAA3B,EAAsD,CAAtD,CAAjC;AACA,WAAS,YAAT,CAAuB,cAAvB,EAAuC,IAAI,MAAM,eAAV,CAA2B,IAAI,YAAJ,CAAiB,YAAjB,CAA3B,EAA2D,CAA3D,CAAvC;AACA,WAAS,YAAT,CAAuB,cAAvB,EAAuC,IAAI,MAAM,eAAV,CAA2B,IAAI,YAAJ,CAAiB,YAAjB,CAA3B,EAA2D,CAA3D,CAAvC;AACA,WAAS,YAAT,CAAuB,IAAvB,EAA6B,IAAI,MAAM,eAAV,CAA2B,IAAI,YAAJ,CAAiB,GAAjB,CAA3B,EAAkD,CAAlD,CAA7B;;AAEA,SAAO,QAAP;AACD,CAzFD","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","/**\n * Tween.js - Licensed under the MIT license\n * https://github.com/tweenjs/tween.js\n * ----------------------------------------------\n *\n * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.\n * Thank you all, you're awesome!\n */\n\nvar TWEEN = TWEEN || (function () {\n\n\tvar _tweens = [];\n\n\treturn {\n\n\t\tgetAll: function () {\n\n\t\t\treturn _tweens;\n\n\t\t},\n\n\t\tremoveAll: function () {\n\n\t\t\t_tweens = [];\n\n\t\t},\n\n\t\tadd: function (tween) {\n\n\t\t\t_tweens.push(tween);\n\n\t\t},\n\n\t\tremove: function (tween) {\n\n\t\t\tvar i = _tweens.indexOf(tween);\n\n\t\t\tif (i !== -1) {\n\t\t\t\t_tweens.splice(i, 1);\n\t\t\t}\n\n\t\t},\n\n\t\tupdate: function (time, preserve) {\n\n\t\t\tif (_tweens.length === 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar i = 0;\n\n\t\t\ttime = time !== undefined ? time : TWEEN.now();\n\n\t\t\twhile (i < _tweens.length) {\n\n\t\t\t\tif (_tweens[i].update(time) || preserve) {\n\t\t\t\t\ti++;\n\t\t\t\t} else {\n\t\t\t\t\t_tweens.splice(i, 1);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t}\n\t};\n\n})();\n\n\n// Include a performance.now polyfill\n(function () {\n\t// In node.js, use process.hrtime.\n\tif (this.window === undefined && this.process !== undefined) {\n\t\tTWEEN.now = function () {\n\t\t\tvar time = process.hrtime();\n\n\t\t\t// Convert [seconds, microseconds] to milliseconds.\n\t\t\treturn time[0] * 1000 + time[1] / 1000;\n\t\t};\n\t}\n\t// In a browser, use window.performance.now if it is available.\n\telse if (this.window !== undefined &&\n\t         window.performance !== undefined &&\n\t\t window.performance.now !== undefined) {\n\n\t\t// This must be bound, because directly assigning this function\n\t\t// leads to an invocation exception in Chrome.\n\t\tTWEEN.now = window.performance.now.bind(window.performance);\n\t}\n\t// Use Date.now if it is available.\n\telse if (Date.now !== undefined) {\n\t\tTWEEN.now = Date.now;\n\t}\n\t// Otherwise, use 'new Date().getTime()'.\n\telse {\n\t\tTWEEN.now = function () {\n\t\t\treturn new Date().getTime();\n\t\t};\n\t}\n})();\n\n\nTWEEN.Tween = function (object) {\n\n\tvar _object = object;\n\tvar _valuesStart = {};\n\tvar _valuesEnd = {};\n\tvar _valuesStartRepeat = {};\n\tvar _duration = 1000;\n\tvar _repeat = 0;\n\tvar _yoyo = false;\n\tvar _isPlaying = false;\n\tvar _reversed = false;\n\tvar _delayTime = 0;\n\tvar _startTime = null;\n\tvar _easingFunction = TWEEN.Easing.Linear.None;\n\tvar _interpolationFunction = TWEEN.Interpolation.Linear;\n\tvar _chainedTweens = [];\n\tvar _onStartCallback = null;\n\tvar _onStartCallbackFired = false;\n\tvar _onUpdateCallback = null;\n\tvar _onCompleteCallback = null;\n\tvar _onStopCallback = null;\n\n\t// Set all starting values present on the target object\n\tfor (var field in object) {\n\t\t_valuesStart[field] = parseFloat(object[field], 10);\n\t}\n\n\tthis.to = function (properties, duration) {\n\n\t\tif (duration !== undefined) {\n\t\t\t_duration = duration;\n\t\t}\n\n\t\t_valuesEnd = properties;\n\n\t\treturn this;\n\n\t};\n\n\tthis.start = function (time) {\n\n\t\tTWEEN.add(this);\n\n\t\t_isPlaying = true;\n\n\t\t_onStartCallbackFired = false;\n\n\t\t_startTime = time !== undefined ? time : TWEEN.now();\n\t\t_startTime += _delayTime;\n\n\t\tfor (var property in _valuesEnd) {\n\n\t\t\t// Check if an Array was provided as property value\n\t\t\tif (_valuesEnd[property] instanceof Array) {\n\n\t\t\t\tif (_valuesEnd[property].length === 0) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Create a local copy of the Array with the start value at the front\n\t\t\t\t_valuesEnd[property] = [_object[property]].concat(_valuesEnd[property]);\n\n\t\t\t}\n\n\t\t\t// If `to()` specifies a property that doesn't exist in the source object,\n\t\t\t// we should not set that property in the object\n\t\t\tif (_valuesStart[property] === undefined) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t_valuesStart[property] = _object[property];\n\n\t\t\tif ((_valuesStart[property] instanceof Array) === false) {\n\t\t\t\t_valuesStart[property] *= 1.0; // Ensures we're using numbers, not strings\n\t\t\t}\n\n\t\t\t_valuesStartRepeat[property] = _valuesStart[property] || 0;\n\n\t\t}\n\n\t\treturn this;\n\n\t};\n\n\tthis.stop = function () {\n\n\t\tif (!_isPlaying) {\n\t\t\treturn this;\n\t\t}\n\n\t\tTWEEN.remove(this);\n\t\t_isPlaying = false;\n\n\t\tif (_onStopCallback !== null) {\n\t\t\t_onStopCallback.call(_object);\n\t\t}\n\n\t\tthis.stopChainedTweens();\n\t\treturn this;\n\n\t};\n\n\tthis.stopChainedTweens = function () {\n\n\t\tfor (var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++) {\n\t\t\t_chainedTweens[i].stop();\n\t\t}\n\n\t};\n\n\tthis.delay = function (amount) {\n\n\t\t_delayTime = amount;\n\t\treturn this;\n\n\t};\n\n\tthis.repeat = function (times) {\n\n\t\t_repeat = times;\n\t\treturn this;\n\n\t};\n\n\tthis.yoyo = function (yoyo) {\n\n\t\t_yoyo = yoyo;\n\t\treturn this;\n\n\t};\n\n\n\tthis.easing = function (easing) {\n\n\t\t_easingFunction = easing;\n\t\treturn this;\n\n\t};\n\n\tthis.interpolation = function (interpolation) {\n\n\t\t_interpolationFunction = interpolation;\n\t\treturn this;\n\n\t};\n\n\tthis.chain = function () {\n\n\t\t_chainedTweens = arguments;\n\t\treturn this;\n\n\t};\n\n\tthis.onStart = function (callback) {\n\n\t\t_onStartCallback = callback;\n\t\treturn this;\n\n\t};\n\n\tthis.onUpdate = function (callback) {\n\n\t\t_onUpdateCallback = callback;\n\t\treturn this;\n\n\t};\n\n\tthis.onComplete = function (callback) {\n\n\t\t_onCompleteCallback = callback;\n\t\treturn this;\n\n\t};\n\n\tthis.onStop = function (callback) {\n\n\t\t_onStopCallback = callback;\n\t\treturn this;\n\n\t};\n\n\tthis.update = function (time) {\n\n\t\tvar property;\n\t\tvar elapsed;\n\t\tvar value;\n\n\t\tif (time < _startTime) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (_onStartCallbackFired === false) {\n\n\t\t\tif (_onStartCallback !== null) {\n\t\t\t\t_onStartCallback.call(_object);\n\t\t\t}\n\n\t\t\t_onStartCallbackFired = true;\n\n\t\t}\n\n\t\telapsed = (time - _startTime) / _duration;\n\t\telapsed = elapsed > 1 ? 1 : elapsed;\n\n\t\tvalue = _easingFunction(elapsed);\n\n\t\tfor (property in _valuesEnd) {\n\n\t\t\t// Don't update properties that do not exist in the source object\n\t\t\tif (_valuesStart[property] === undefined) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar start = _valuesStart[property] || 0;\n\t\t\tvar end = _valuesEnd[property];\n\n\t\t\tif (end instanceof Array) {\n\n\t\t\t\t_object[property] = _interpolationFunction(end, value);\n\n\t\t\t} else {\n\n\t\t\t\t// Parses relative end values with start as base (e.g.: +10, -3)\n\t\t\t\tif (typeof (end) === 'string') {\n\n\t\t\t\t\tif (end.charAt(0) === '+' || end.charAt(0) === '-') {\n\t\t\t\t\t\tend = start + parseFloat(end, 10);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tend = parseFloat(end, 10);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Protect against non numeric properties.\n\t\t\t\tif (typeof (end) === 'number') {\n\t\t\t\t\t_object[property] = start + (end - start) * value;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif (_onUpdateCallback !== null) {\n\t\t\t_onUpdateCallback.call(_object, value);\n\t\t}\n\n\t\tif (elapsed === 1) {\n\n\t\t\tif (_repeat > 0) {\n\n\t\t\t\tif (isFinite(_repeat)) {\n\t\t\t\t\t_repeat--;\n\t\t\t\t}\n\n\t\t\t\t// Reassign starting values, restart by making startTime = now\n\t\t\t\tfor (property in _valuesStartRepeat) {\n\n\t\t\t\t\tif (typeof (_valuesEnd[property]) === 'string') {\n\t\t\t\t\t\t_valuesStartRepeat[property] = _valuesStartRepeat[property] + parseFloat(_valuesEnd[property], 10);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (_yoyo) {\n\t\t\t\t\t\tvar tmp = _valuesStartRepeat[property];\n\n\t\t\t\t\t\t_valuesStartRepeat[property] = _valuesEnd[property];\n\t\t\t\t\t\t_valuesEnd[property] = tmp;\n\t\t\t\t\t}\n\n\t\t\t\t\t_valuesStart[property] = _valuesStartRepeat[property];\n\n\t\t\t\t}\n\n\t\t\t\tif (_yoyo) {\n\t\t\t\t\t_reversed = !_reversed;\n\t\t\t\t}\n\n\t\t\t\t_startTime = time + _delayTime;\n\n\t\t\t\treturn true;\n\n\t\t\t} else {\n\n\t\t\t\tif (_onCompleteCallback !== null) {\n\t\t\t\t\t_onCompleteCallback.call(_object);\n\t\t\t\t}\n\n\t\t\t\tfor (var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++) {\n\t\t\t\t\t// Make the chained tweens start exactly at the time they should,\n\t\t\t\t\t// even if the `update()` method was called way past the duration of the tween\n\t\t\t\t\t_chainedTweens[i].start(_startTime + _duration);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t};\n\n};\n\n\nTWEEN.Easing = {\n\n\tLinear: {\n\n\t\tNone: function (k) {\n\n\t\t\treturn k;\n\n\t\t}\n\n\t},\n\n\tQuadratic: {\n\n\t\tIn: function (k) {\n\n\t\t\treturn k * k;\n\n\t\t},\n\n\t\tOut: function (k) {\n\n\t\t\treturn k * (2 - k);\n\n\t\t},\n\n\t\tInOut: function (k) {\n\n\t\t\tif ((k *= 2) < 1) {\n\t\t\t\treturn 0.5 * k * k;\n\t\t\t}\n\n\t\t\treturn - 0.5 * (--k * (k - 2) - 1);\n\n\t\t}\n\n\t},\n\n\tCubic: {\n\n\t\tIn: function (k) {\n\n\t\t\treturn k * k * k;\n\n\t\t},\n\n\t\tOut: function (k) {\n\n\t\t\treturn --k * k * k + 1;\n\n\t\t},\n\n\t\tInOut: function (k) {\n\n\t\t\tif ((k *= 2) < 1) {\n\t\t\t\treturn 0.5 * k * k * k;\n\t\t\t}\n\n\t\t\treturn 0.5 * ((k -= 2) * k * k + 2);\n\n\t\t}\n\n\t},\n\n\tQuartic: {\n\n\t\tIn: function (k) {\n\n\t\t\treturn k * k * k * k;\n\n\t\t},\n\n\t\tOut: function (k) {\n\n\t\t\treturn 1 - (--k * k * k * k);\n\n\t\t},\n\n\t\tInOut: function (k) {\n\n\t\t\tif ((k *= 2) < 1) {\n\t\t\t\treturn 0.5 * k * k * k * k;\n\t\t\t}\n\n\t\t\treturn - 0.5 * ((k -= 2) * k * k * k - 2);\n\n\t\t}\n\n\t},\n\n\tQuintic: {\n\n\t\tIn: function (k) {\n\n\t\t\treturn k * k * k * k * k;\n\n\t\t},\n\n\t\tOut: function (k) {\n\n\t\t\treturn --k * k * k * k * k + 1;\n\n\t\t},\n\n\t\tInOut: function (k) {\n\n\t\t\tif ((k *= 2) < 1) {\n\t\t\t\treturn 0.5 * k * k * k * k * k;\n\t\t\t}\n\n\t\t\treturn 0.5 * ((k -= 2) * k * k * k * k + 2);\n\n\t\t}\n\n\t},\n\n\tSinusoidal: {\n\n\t\tIn: function (k) {\n\n\t\t\treturn 1 - Math.cos(k * Math.PI / 2);\n\n\t\t},\n\n\t\tOut: function (k) {\n\n\t\t\treturn Math.sin(k * Math.PI / 2);\n\n\t\t},\n\n\t\tInOut: function (k) {\n\n\t\t\treturn 0.5 * (1 - Math.cos(Math.PI * k));\n\n\t\t}\n\n\t},\n\n\tExponential: {\n\n\t\tIn: function (k) {\n\n\t\t\treturn k === 0 ? 0 : Math.pow(1024, k - 1);\n\n\t\t},\n\n\t\tOut: function (k) {\n\n\t\t\treturn k === 1 ? 1 : 1 - Math.pow(2, - 10 * k);\n\n\t\t},\n\n\t\tInOut: function (k) {\n\n\t\t\tif (k === 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif (k === 1) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif ((k *= 2) < 1) {\n\t\t\t\treturn 0.5 * Math.pow(1024, k - 1);\n\t\t\t}\n\n\t\t\treturn 0.5 * (- Math.pow(2, - 10 * (k - 1)) + 2);\n\n\t\t}\n\n\t},\n\n\tCircular: {\n\n\t\tIn: function (k) {\n\n\t\t\treturn 1 - Math.sqrt(1 - k * k);\n\n\t\t},\n\n\t\tOut: function (k) {\n\n\t\t\treturn Math.sqrt(1 - (--k * k));\n\n\t\t},\n\n\t\tInOut: function (k) {\n\n\t\t\tif ((k *= 2) < 1) {\n\t\t\t\treturn - 0.5 * (Math.sqrt(1 - k * k) - 1);\n\t\t\t}\n\n\t\t\treturn 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\n\n\t\t}\n\n\t},\n\n\tElastic: {\n\n\t\tIn: function (k) {\n\n\t\t\tif (k === 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif (k === 1) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn -Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\n\n\t\t},\n\n\t\tOut: function (k) {\n\n\t\t\tif (k === 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif (k === 1) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn Math.pow(2, -10 * k) * Math.sin((k - 0.1) * 5 * Math.PI) + 1;\n\n\t\t},\n\n\t\tInOut: function (k) {\n\n\t\t\tif (k === 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif (k === 1) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tk *= 2;\n\n\t\t\tif (k < 1) {\n\t\t\t\treturn -0.5 * Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\n\t\t\t}\n\n\t\t\treturn 0.5 * Math.pow(2, -10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI) + 1;\n\n\t\t}\n\n\t},\n\n\tBack: {\n\n\t\tIn: function (k) {\n\n\t\t\tvar s = 1.70158;\n\n\t\t\treturn k * k * ((s + 1) * k - s);\n\n\t\t},\n\n\t\tOut: function (k) {\n\n\t\t\tvar s = 1.70158;\n\n\t\t\treturn --k * k * ((s + 1) * k + s) + 1;\n\n\t\t},\n\n\t\tInOut: function (k) {\n\n\t\t\tvar s = 1.70158 * 1.525;\n\n\t\t\tif ((k *= 2) < 1) {\n\t\t\t\treturn 0.5 * (k * k * ((s + 1) * k - s));\n\t\t\t}\n\n\t\t\treturn 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\n\n\t\t}\n\n\t},\n\n\tBounce: {\n\n\t\tIn: function (k) {\n\n\t\t\treturn 1 - TWEEN.Easing.Bounce.Out(1 - k);\n\n\t\t},\n\n\t\tOut: function (k) {\n\n\t\t\tif (k < (1 / 2.75)) {\n\t\t\t\treturn 7.5625 * k * k;\n\t\t\t} else if (k < (2 / 2.75)) {\n\t\t\t\treturn 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\n\t\t\t} else if (k < (2.5 / 2.75)) {\n\t\t\t\treturn 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\n\t\t\t} else {\n\t\t\t\treturn 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\n\t\t\t}\n\n\t\t},\n\n\t\tInOut: function (k) {\n\n\t\t\tif (k < 0.5) {\n\t\t\t\treturn TWEEN.Easing.Bounce.In(k * 2) * 0.5;\n\t\t\t}\n\n\t\t\treturn TWEEN.Easing.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;\n\n\t\t}\n\n\t}\n\n};\n\nTWEEN.Interpolation = {\n\n\tLinear: function (v, k) {\n\n\t\tvar m = v.length - 1;\n\t\tvar f = m * k;\n\t\tvar i = Math.floor(f);\n\t\tvar fn = TWEEN.Interpolation.Utils.Linear;\n\n\t\tif (k < 0) {\n\t\t\treturn fn(v[0], v[1], f);\n\t\t}\n\n\t\tif (k > 1) {\n\t\t\treturn fn(v[m], v[m - 1], m - f);\n\t\t}\n\n\t\treturn fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\n\n\t},\n\n\tBezier: function (v, k) {\n\n\t\tvar b = 0;\n\t\tvar n = v.length - 1;\n\t\tvar pw = Math.pow;\n\t\tvar bn = TWEEN.Interpolation.Utils.Bernstein;\n\n\t\tfor (var i = 0; i <= n; i++) {\n\t\t\tb += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);\n\t\t}\n\n\t\treturn b;\n\n\t},\n\n\tCatmullRom: function (v, k) {\n\n\t\tvar m = v.length - 1;\n\t\tvar f = m * k;\n\t\tvar i = Math.floor(f);\n\t\tvar fn = TWEEN.Interpolation.Utils.CatmullRom;\n\n\t\tif (v[0] === v[m]) {\n\n\t\t\tif (k < 0) {\n\t\t\t\ti = Math.floor(f = m * (1 + k));\n\t\t\t}\n\n\t\t\treturn fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\n\n\t\t} else {\n\n\t\t\tif (k < 0) {\n\t\t\t\treturn v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\n\t\t\t}\n\n\t\t\tif (k > 1) {\n\t\t\t\treturn v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\n\t\t\t}\n\n\t\t\treturn fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\n\n\t\t}\n\n\t},\n\n\tUtils: {\n\n\t\tLinear: function (p0, p1, t) {\n\n\t\t\treturn (p1 - p0) * t + p0;\n\n\t\t},\n\n\t\tBernstein: function (n, i) {\n\n\t\t\tvar fc = TWEEN.Interpolation.Utils.Factorial;\n\n\t\t\treturn fc(n) / fc(i) / fc(n - i);\n\n\t\t},\n\n\t\tFactorial: (function () {\n\n\t\t\tvar a = [1];\n\n\t\t\treturn function (n) {\n\n\t\t\t\tvar s = 1;\n\n\t\t\t\tif (a[n]) {\n\t\t\t\t\treturn a[n];\n\t\t\t\t}\n\n\t\t\t\tfor (var i = n; i > 1; i--) {\n\t\t\t\t\ts *= i;\n\t\t\t\t}\n\n\t\t\t\ta[n] = s;\n\t\t\t\treturn s;\n\n\t\t\t};\n\n\t\t})(),\n\n\t\tCatmullRom: function (p0, p1, p2, p3, t) {\n\n\t\t\tvar v0 = (p2 - p0) * 0.5;\n\t\t\tvar v1 = (p3 - p1) * 0.5;\n\t\t\tvar t2 = t * t;\n\t\t\tvar t3 = t * t2;\n\n\t\t\treturn (2 * p1 - 2 * p2 + v0 + v1) * t3 + (- 3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\n\n\t\t}\n\n\t}\n\n};\n\n// UMD (Universal Module Definition)\n(function (root) {\n\n\tif (typeof define === 'function' && define.amd) {\n\n\t\t// AMD\n\t\tdefine([], function () {\n\t\t\treturn TWEEN;\n\t\t});\n\n\t} else if (typeof module !== 'undefined' && typeof exports === 'object') {\n\n\t\t// Node.js\n\t\tmodule.exports = TWEEN;\n\n\t} else if (root !== undefined) {\n\n\t\t// Global variable\n\t\troot.TWEEN = TWEEN;\n\n\t}\n\n})(this);\n","'use strict';\n\n// var CANNON = require( 'cannon' );\n\nvar CannonController = function(options){\n\n  options = options || {};\n\n  var fixedTimeStep = options.fixedTimeStep ||  1 / 60; // seconds \n  var maxSubSteps = options.maxSubSteps ||  4;\n\n  var world = new CANNON.World();\n\n  world.broadphase = new CANNON.NaiveBroadphase();\n\n  world.gravity = options.gravity ||  new CANNON.Vec3(0, -982, 0); // m/s \n\n  var bodies = world.bodies;\n\n  var lastTime;\n\n  var v3 = function(x,y,z){ new CANNON.Vec3(x,y,z); };\n\n  function update( time ){\n\n    if(lastTime !== undefined){\n\n       world.step( fixedTimeStep, time - lastTime, maxSubSteps );\n\n    }\n\n    lastTime = time;\n\n  }\n\n  function addBody( shape, params ){\n    \n    var body = new CANNON.Body( params );\n    \n    body.addShape( shape );\n\n    world.add( body ); \n\n    return body;\n  }\n\n  function removeBody( body ){\n\n    world.removeBody( body );\n\n  }\n\n  function removeConstraint( constraint ){\n    world.removeConstraint(constraint);\n  }\n\n\n  function addConstraint( constraint ){\n    \n    world.addConstraint( constraint );\n\n    return constraint; \n  }\n\n\n  function addPointConstraint( bodyA, localPivotA, bodyB, localPivotB, collideConnected, options ){\n    \n    var constraint = new CANNON.PointToPointConstraint(\n      bodyA,\n      localPivotA,\n      bodyB,\n      localPivotB);\n\n    constraint.collideConnected = collideConnected !== undefined? collideConnected : false;\n    \n    return addConstraint( constraint );\n  }\n\n  function addHingeConstraint( bodyA, pivotA, axisA, bodyB, pivotB, axisB, maxForce, collideConnected, enableMoter)\n  {\n    var constraint = new CANNON.HingeConstraint( bodyA, bodyB, {\n      pivotA: pivotA,\n      pivotB: pivotB,\n      axisA: axisA, //new CANNON.Vec3(1,0,0),\n      axisB: axisB, //new CANNON.Vec3(1,0,0),\n      maxForce: maxForce\n    });\n\n    constraint.collideConnected = collideConnected !== undefined? collideConnected : false;\n\n    if(enableMoter === true)  constraint.enableMotor();\n\n    return addConstraint( constraint );\n  }\n\n  function addConeConstraint( bodyA, pivotA, axisA, bodyB, pivotB, axisB, maxForce, twistAngle, collideConnected ){\n\n    var constraint = new CANNON.ConeTwistConstraint( bodyA, bodyB, {\n        pivotA: pivotA,\n        pivotB: pivotB,\n        axisA: axisA,\n        axisB: axisB,\n        maxForce: maxForce || Infinity,\n        // collideConnected: collideConnected !== undefined? collideConnected : false\n    });\n\n    constraint.twistAngle = twistAngle || 1;\n\n    constraint.collideConnected = collideConnected !== undefined? collideConnected : false;\n\n    return addConstraint( constraint );\n  }\n\n  function addLockConstraint( bodyA, bodyB, maxForce, collideConnected ){\n    var constraint = new CANNON.LockConstraint ( bodyA, bodyB, {\n      maxForce: maxForce\n    } );\n\n    constraint.collideConnected = collideConnected !== undefined? collideConnected : false;\n\n    return addConstraint( constraint );\n  }\n\n  function addSphere( radius, options ){\n\n    var sphereShape = new CANNON.Sphere( radius );\n\n    return addBody( sphereShape, options );\n  }\n\n  function addBox( halfExtents, options ){\n\n    var box = new CANNON.Box( halfExtents || v3( 0.5, 0.5, 0.5 ) );\n\n    return addBody( box, options );\n  }\n\n  function addPlane( options ){\n\n    var plane = new CANNON.Plane();\n\n    return addBody( plane, options );\n\n  }\n\n  return {\n\n    world: world,\n\n    gravity: world.gravity,\n\n    bodies: bodies,\n\n    update: update,\n\n    addBody: addBody,\n\n    removeBody: removeBody,\n    \n    removeConstraint: removeConstraint,\n\n    addConstraint: addConstraint,\n\n    addPointConstraint: addPointConstraint,\n\n    addConeConstraint: addConeConstraint,\n\n    addHingeConstraint: addHingeConstraint,\n\n    addLockConstraint: addLockConstraint,\n\n    addSphere: addSphere,\n\n    addBox: addBox,\n\n    addPlane: addPlane,\n\n    addBoxMesh: function( boxMesh, options ){\n\n      if(!boxMesh.geometry.boundingBox){\n        boxMesh.geometry.computeBoundingBox();\n      }\n\n      var extents = boxMesh.geometry.boundingBox.getSize().multiply( boxMesh.scale );\n\n      var halfExtents = new CANNON.Vec3( extents.x * 0.5, extents.y * 0.5, extents.z * 0.5 );\n\n      return addBox( halfExtents, options );\n\n    }\n\n  };\n\n};\n\n\nmodule.exports = CannonController;\n","'use strict';\n\n\nvar Joint = function ( options ) {\n\n  THREE.Object3D.call( this );\n\n  this.type = 'Joint';\n\n  this.offset = new THREE.Matrix4();\n\n  this.transform = new THREE.Matrix4();\n\n  Object.assign(this, options || {});\n\n  this.applyMatrix(this.transform);\n\n  this.setOffset();\n\n};\n\nJoint.prototype = Object.create( THREE.Object3D.prototype );\nJoint.prototype.constructor = Joint;\n\nJoint.prototype.setOffset = function(){\n\n  this.updateMatrixWorld();\n\n  this.offset.getInverse( this.matrixWorld );\n\n}\n\nJoint.prototype.updateTransform = function() {\n\n  this.updateMatrixWorld();\n\n  this.transform.copy( this.matrixWorld ).multiply( this.offset ); \n\n}\n\n\nmodule.exports = Joint;","// JointMaterial.js\n'use strict'\n\nvar glslify = require('glslify');\n\nvar JointMaterial = function(jointTransforms, options) {\n\n  options = options || {}\n  \n  var mat = {\n\n    transparent: true,\n\n    blending: 0,\n\n    wireframe: false,\n\n    depthTest: true,\n\n    depthWrite: true,\n\n    side: 0,\n\n    lights: true,\n\n    // map: options.map,\n\n    // jointTexture: options.jointTexture,\n\n\n\n    uniforms: Object.assign( {},\n      THREE.UniformsLib.common,\n      THREE.UniformsLib.aomap,\n      THREE.UniformsLib.lightmap,\n      THREE.UniformsLib.emissivemap,\n      THREE.UniformsLib.bumpmap,\n      THREE.UniformsLib.normalmap,\n      THREE.UniformsLib.displacementmap,\n      THREE.UniformsLib.fog,\n      THREE.UniformsLib.lights,\n      {\n        emissive : { value: new THREE.Color( 0x111520 ) },\n        specular : { value: new THREE.Color( 0x333333 ) },\n        shininess: { value: 12 },\n        hitVal: {type: 'f', value: 0},\n        hitColor: {type: 'c', value: new THREE.Color(0xFF0000)},\n        // joints: {type: 'm4v', value: jointTransforms },\n        map: {type: 't', value: undefined},\n        jointTexture: {type: 't', value: undefined},\n        jointTextureDim: {type: 'v2', value: options.jointTextureDim || new THREE.Vector2( 4, 64 ) }\n      }\n    ),\n\n    vertexShader: [\n\n    '#define PHONG',\n        \n    \"#define USE_MAP\",\n\n    // \"#define FLAT_SHADED\",\n\n\n    'varying vec3 vViewPosition;',\n\n    // '#ifndef FLAT_SHADED',\n\n      'varying vec3 vNormal;',\n\n    // '#endif',\n\n\n    // \"uniform mat4 joints[\"+ jointTransforms.length +\"];\",\n\n    // \"attribute vec3 normal;\",\n\n    \"attribute vec3 jointWeights;\",\n\n    \"attribute vec3 jointIndices;\",\n\n    'uniform sampler2D jointTexture;',\n\n    'uniform vec2 jointTextureDim;',\n\n    'uniform float hitVal;',\n\n    'varying float vHitVal;',\n\n\n    THREE.ShaderChunk['common'],\n    THREE.ShaderChunk['uv_pars_vertex'],\n    THREE.ShaderChunk['uv2_pars_vertex'],\n    THREE.ShaderChunk['displacementmap_pars_vertex'],\n    THREE.ShaderChunk['envmap_pars_vertex'],\n    THREE.ShaderChunk['color_pars_vertex'],\n    THREE.ShaderChunk['morphtarget_pars_vertex'],\n    THREE.ShaderChunk['skinning_pars_vertex'],\n    THREE.ShaderChunk['shadowmap_pars_vertex'],\n    THREE.ShaderChunk['logdepthbuf_pars_vertex'],\n    THREE.ShaderChunk['clipping_planes_pars_vertex'],\n\n    'void main() {',\n\n      THREE.ShaderChunk['uv_vertex'],\n      THREE.ShaderChunk['uv2_vertex'],\n      THREE.ShaderChunk['color_vertex'],\n\n      'vHitVal = max(0.0, hitVal * (-position.y + 50.0) * 0.1);',\n\n\n      // THREE.ShaderChunk['begin_vertex'],\n      \"mat4 jointMatrix = mat4( 0.0 );\",\n\n      \"vec3 jw = normalize(jointWeights.xyz);\",\n\n      \"for(int i=0; i<3; i++){\",\n\n      '  vec4 v0 = texture2D( jointTexture, vec2(0.0, jointIndices[i]) / jointTextureDim );',\n      '  vec4 v1 = texture2D( jointTexture, vec2(1.0, jointIndices[i]) / jointTextureDim );',\n      '  vec4 v2 = texture2D( jointTexture, vec2(2.0, jointIndices[i]) / jointTextureDim );',\n      '  vec4 v3 = texture2D( jointTexture, vec2(3.0, jointIndices[i]) / jointTextureDim );',\n      \n      '  jointMatrix += jw[i] * mat4(v0, v1, v2, v3);',\n\n      \"}\",\n\n      'vec3 transformed = vec3( position );',\n\n\n      // THREE.ShaderChunk['beginnormal_vertex'],\n      'vec3 objectNormal = (jointMatrix * vec4(normal, 0.)).xyz;',\n\n      THREE.ShaderChunk['morphnormal_vertex'],\n      THREE.ShaderChunk['skinbase_vertex'],\n      THREE.ShaderChunk['skinnormal_vertex'],\n      \n      // THREE.ShaderChunk['defaultnormal_vertex'],\n      'vec3 transformedNormal = normalMatrix * objectNormal;',\n\n      THREE.ShaderChunk['displacementmap_vertex'],\n      THREE.ShaderChunk['morphtarget_vertex'],\n      // THREE.ShaderChunk['skinning_vertex'],\n      // THREE.ShaderChunk['project_vertex'],\n\n\n      // THREE.ShaderChunk['worldpos_vertex'],\n      // 'vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );',\n      'vec4 worldPosition = modelMatrix * jointMatrix * vec4( transformed, 1.0 );',\n      \"vec4 mvPosition = viewMatrix * worldPosition;\",\n      \"gl_Position = projectionMatrix * mvPosition;\",\n      \n      \n      THREE.ShaderChunk['logdepthbuf_vertex'],\n      THREE.ShaderChunk['clipping_planes_vertex'],\n\n\n      \" vViewPosition = -mvPosition.xyz;\",\n\n      'vNormal = normalize( transformedNormal );',\n\n      THREE.ShaderChunk['envmap_vertex'],\n      THREE.ShaderChunk['shadowmap_vertex'],\n\n    '}',\n\n    ].join('\\n'),\n\n    fragmentShader: [\n      '#define PHONG',\n      \n      \"#define USE_MAP\",\n\n      'uniform vec3 diffuse;',\n      'uniform vec3 emissive;',\n      'uniform vec3 specular;',\n      'uniform float shininess;',\n      'uniform float opacity;',\n      \n      'uniform vec3 hitColor;',\n      'varying float vHitVal;',\n\n      THREE.ShaderChunk['common'],\n      THREE.ShaderChunk['packing'],\n      THREE.ShaderChunk['color_pars_fragment'],\n      THREE.ShaderChunk['uv_pars_fragment'],\n      THREE.ShaderChunk['uv2_pars_fragment'],\n      THREE.ShaderChunk['map_pars_fragment'],\n      THREE.ShaderChunk['alphamap_pars_fragment'],\n      THREE.ShaderChunk['aomap_pars_fragment'],\n      THREE.ShaderChunk['lightmap_pars_fragment'],\n      THREE.ShaderChunk['emissivemap_pars_fragment'],\n      THREE.ShaderChunk['envmap_pars_fragment'],\n      THREE.ShaderChunk['fog_pars_fragment'],\n      THREE.ShaderChunk['bsdfs'],\n      THREE.ShaderChunk['lights_pars'],\n      THREE.ShaderChunk['lights_phong_pars_fragment'],\n      THREE.ShaderChunk['shadowmap_pars_fragment'],\n      THREE.ShaderChunk['bumpmap_pars_fragment'],\n      THREE.ShaderChunk['normalmap_pars_fragment'],\n      THREE.ShaderChunk['specularmap_pars_fragment'],\n      THREE.ShaderChunk['logdepthbuf_pars_fragment'],\n      THREE.ShaderChunk['clipping_planes_pars_fragment'],\n\n      'void main() {',\n\n        'gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);',\n\n        THREE.ShaderChunk['clipping_planes_fragment'],\n\n        'vec4 diffuseColor = vec4( diffuse, opacity );',\n        'ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );',\n        'vec3 totalEmissiveRadiance = emissive;',\n\n        THREE.ShaderChunk['logdepthbuf_fragment'],\n        THREE.ShaderChunk['map_fragment'],\n        THREE.ShaderChunk['color_fragment'],\n        THREE.ShaderChunk['alphamap_fragment'],\n        THREE.ShaderChunk['alphatest_fragment'],\n        THREE.ShaderChunk['specularmap_fragment'],\n        THREE.ShaderChunk['normal_flip'],\n        THREE.ShaderChunk['normal_fragment'],\n        THREE.ShaderChunk['emissivemap_fragment'],\n\n        // accumulation\n        THREE.ShaderChunk['lights_phong_fragment'],\n        THREE.ShaderChunk['lights_template'],\n\n        // modulation\n        THREE.ShaderChunk['aomap_fragment'],\n\n        'vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;',\n\n        THREE.ShaderChunk['envmap_fragment'],\n\n        'gl_FragColor = vec4( outgoingLight, diffuseColor.a );',\n\n        THREE.ShaderChunk['premultiplied_alpha_fragment'],\n        THREE.ShaderChunk['tonemapping_fragment'],\n        THREE.ShaderChunk['encodings_fragment'],\n        THREE.ShaderChunk['fog_fragment'],\n\n        'gl_FragColor.xyz = mix(gl_FragColor.xyz, hitColor, min(0.75, vHitVal));',\n\n      '}',\n    ].join( \"\\n\" )\n\n  };\n\n\n  Object.assign(mat, options || {});\n\n  THREE.ShaderMaterial.call(this, mat);\n\n  this.castShadow = true;\n\n  this.needsUpdate = true;\n\n};\n\n\n/**\n * @extends {THREE.ShaderMaterial}\n */\nJointMaterial.prototype = Object.create(\n    THREE.ShaderMaterial.prototype);\n\n\n/**\n * common js\n */\nmodule.exports = JointMaterial;\n","\n\nvar JointTexture = function(jointTransforms) {\n    \n  this.transforms = jointTransforms;\n\n  let w = 4; // 4 pixels needed for 1 matrix\n  let h = THREE.Math.nextPowerOfTwo(jointTransforms.length);\n\n  this.jointData = new Float32Array(w * h * 4);\n\n  for(var i=0; i<this.transforms.length; i++) {\n    this.transforms[i].toArray( this.jointData, i * 16 );\n  }\n\n  this.texture = new THREE.DataTexture( this.jointData, w, h, THREE.RGBAFormat, THREE.FloatType );\n\n  this.texture.minFilter = this.texture.magFilter = THREE.NearestFilter;\n\n};\n\n\n\nJointTexture.prototype.constructor = JointTexture;\n\n\n\nJointTexture.prototype.update = function(){\n  \n  for(var i=0; i<this.transforms.length; i++) {\n  \n    this.transforms[i].toArray( this.jointData, i * 16 );\n  \n  }\n\n  this.texture.needsUpdate = true;\n\n}\n\n\n\nmodule.exports = JointTexture;","// LaserOimoWrapper.js\n\n'use strict'\n\nvar LaserOimoWrapper = function( options ){\n\n  options = options || {};\n\n  this.bodies = [];\n\n\n\n  // TimeStep, BroadPhaseType, Iterations, NoStat \n  this.world = new OIMO.World( options.timeStep || 1/60, 2, options.iterations || 10);\n  // this.world = new OIMO.World();\n  this.world.worldscale(100);\n\n  this.gravity = this.world.gravity;\n\n  this.defaultConfig = [\n    1, // The density of the shape.\n    0.4, // The coefficient of friction of the shape.\n    0.25, // The coefficient of restitution of the shape.\n    1, // The bits of the collision groups to which the shape belongs.\n    0xffffffff // The bits of the collision groups with which the shape collides.\n  ];\n\n  this.defaultAxis = new OIMO.Vec3(1,0,0);\n\n\n\n  for(var i in options){\n    this[i] = options[i];\n  }\n  \n}\n\n\nLaserOimoWrapper.prototype.update = function(){\n  this.world.step();\n\n  // update mesh positions\n}\n\n\n\nLaserOimoWrapper.prototype.removeBody = function( b ){\n\n  this.world.removeRigidBody( b );\n\n}\n\n\nLaserOimoWrapper.prototype.makeConfig = function(options) {\n  let config = this.defaultConfig.slice();\n\n  if(options.density !== undefined)       config[0] = options.density;\n  if(options.friction !== undefined)      config[1] = options.friction;\n  if(options.restitution !== undefined)   config[2] = options.restitution;\n  if(options.belongsTo !== undefined)     config[3] = options.belongsTo;\n  if(options.collidesWith !== undefined)  config[4] = options.collidesWith;\n\n  return config;\n};\n\n\n\nLaserOimoWrapper.prototype.addBox = function(\n  dimensions,\n  pos,\n  euler,\n  options){\n\n  let config = this.makeConfig(options);\n\n  var b = {\n    type:\"box\",\n    size:[dimensions.x,dimensions.y,dimensions.z],\n    pos:[pos.x,pos.y,pos.z],\n    rot:[euler.x,euler.y,euler.z],\n    move: options.move !== undefined ? options.move : true,\n    config: config\n  };\n\n  Object.assign(b, options || {});\n\n  return this.world.add( b );\n}\n\nLaserOimoWrapper.prototype.addSphere = function(\n  rad,\n  pos,\n  euler,\n  options){\n\n  let config = this.makeConfig(options);\n\n  var b = {\n    type:\"sphere\",\n    size:[rad,rad,rad],\n    pos:[pos.x,pos.y,pos.z],\n    rot:[euler.x,euler.y,euler.z],\n    move: options.move !== undefined ? options.move : true,\n    config: config\n  };\n\n  Object.assign(b, options || {});\n\n  return this.world.add( b );\n}\n\nLaserOimoWrapper.prototype.addFromMesh = function(m, type, options) {\n  \n  if(!m.geometry.boundingBox){\n    m.geometry.computeBoundingBox();\n  }\n\n  var dimensions = m.geometry.boundingBox.getSize().multiply(m.scale);\n\n  var b;\n\n  if(type === 'box' || type === undefined){\n    b = this.addBox(dimensions, m.position, m.rotation, options);\n  }\n  else if( type === 'sphere' ){\n    b = this.addSphere( dimensions.x * 0.5, m.position, m.rotation, options);\n  }\n\n  return b;\n  \n};\n\nLaserOimoWrapper.prototype.getJointConfig = function(a, b, options){\n\n  // https://github.com/lo-th/Oimo.js/blob/gh-pages/src/constraint/joint/JointConfig.js\n\n  options = options || {};\n  \n  var jc = new OIMO.JointConfig();\n\n  jc.body1 = a;\n  \n  jc.body2 = b;\n  \n  if(options.pointInA)  jc.localAnchorPoint1.copy( options.pointInA ).multiplyScalar(OIMO.INV_SCALE);\n  \n  if(options.pointInB)  jc.localAnchorPoint2.copy( options.pointInB ).multiplyScalar(OIMO.INV_SCALE);\n  \n  if(options.axisA) jc.localAxis1.copy(options.axisA);\n  \n  if(options.axisB) jc.localAxis2.copy(options.axisB);\n  \n  jc.allowCollision = options.allowCollision || false;\n\n  return jc;\n}\n\n\nLaserOimoWrapper.prototype.pointToPoint = function( a, b, options ){\n\n  options = options || {};\n  \n  var jc = this.getJointConfig(a, b, options);\n\n  var joint = new OIMO.DistanceJoint( jc, options.min || 0, options.max || 0.001 );\n\n  this.world.addJoint(joint);\n\n  return joint;\n}\n\n\n\nLaserOimoWrapper.prototype.removeConstraint = function( constraint ){\n  this.world.removeJoint(constraint);\n}\n\n\n\nLaserOimoWrapper.prototype.hingeJoint = function( a, b, options ){\n\n  options = options || {};\n\n  var spring = options.spring;\n  var motor = options.motor;\n  var min = (options.min || -60) * OIMO.degtorad;\n  var max = (options.max || 60) * OIMO.degtorad;\n  \n  var jc = this.getJointConfig(a, b, options);\n\n  var joint = new OIMO.HingeJoint( jc, min, max );\n\n  if(spring) joint.limitMotor.setSpring(spring[0], spring[1]);// soften the joint ex: 100, 0.2\n\n  if(motor) joint.limitMotor.setMotor(motor[0], motor[1]);\n\n  this.world.addJoint(joint);\n\n  return joint;\n}\n\n\n\nLaserOimoWrapper.prototype.distanceJoint = function( a, b, options ){\n\n  options = options || {};\n\n  var spring = options.spring;\n  var motor = options.motor;\n  var min = (options.min || -60) * OIMO.degtorad;\n  var max = (options.max || 60) * OIMO.degtorad;\n  \n  var jc = this.getJointConfig(a, b, options);\n\n  var joint = new OIMO.DistanceJoint( jc, min, max );\n\n  if(spring) joint.limitMotor.setSpring(spring[0], spring[1]);\n\n  if(motor) joint.limitMotor.setMotor(motor[0], motor[1]);\n\n  this.world.addJoint(joint);\n\n  return joint;\n}\n\n\nLaserOimoWrapper.prototype.slideJoint = function( a, b, options ){\n\n  options = options || {};\n\n  var min = (options.min || -60) * OIMO.degtorad;\n  var max = (options.max || 60) * OIMO.degtorad;\n  \n  var jc = this.getJointConfig(a, b, options);\n\n  var joint = new OIMO.SliderJoint( jc, min, max );\n\n  this.world.addJoint(joint);\n\n  return joint;\n}\n\n\nLaserOimoWrapper.prototype.PrismaticJoint = function( a, b, options ){\n\n  options = options || {};\n\n  var min = (options.min || -60) * OIMO.degtorad;\n  var max = (options.max || 60) * OIMO.degtorad;\n  \n  var jc = this.getJointConfig(a, b, options);\n\n  var joint = new OIMO.PrismaticJoint( jc, min, max );\n\n  this.world.addJoint(joint);\n\n  return joint;\n}\n\n\nLaserOimoWrapper.prototype.ballJoint = function( a, b, options ){\n\n  options = options || {};\n\n  var min = (options.min || -60) * OIMO.degtorad;\n  var max = (options.max || 60) * OIMO.degtorad;\n  \n  var jc = this.getJointConfig(a, b, options);\n\n  var joint = new OIMO.BallAndSocketJoint( jc, min, max );\n\n  this.world.addJoint(joint);\n\n  return joint;\n}\n\n\nmodule.exports = LaserOimoWrapper;\n","\nmodule.exports = (mat, jointTransforms) => {\n\n  return new THREE.ShaderMaterial({\n      \n      vertexShader: [\n\n      // \"uniform mat4 joints[\"+ jointTransforms.length +\"];\",\n\n      \"attribute vec3 jointWeights;\",\n\n      \"attribute vec3 jointIndices;\",\n\n      'uniform sampler2D jointTexture;',\n\n      'uniform vec2 jointTextureDim;',\n\n      'void main() {',\n\n\n      \"mat4 jointMatrix = mat4( 0.0 );\",\n\n      \"vec3 jw = normalize(jointWeights.xyz);\",\n\n      \"for(int i=0; i<3; i++){\",\n\n      '  vec4 v0 = texture2D( jointTexture, vec2(0.0, jointIndices[i]) / jointTextureDim );',\n      '  vec4 v1 = texture2D( jointTexture, vec2(1.0, jointIndices[i]) / jointTextureDim );',\n      '  vec4 v2 = texture2D( jointTexture, vec2(2.0, jointIndices[i]) / jointTextureDim );',\n      '  vec4 v3 = texture2D( jointTexture, vec2(3.0, jointIndices[i]) / jointTextureDim );',\n      \n      '  jointMatrix += jw[i] * mat4(v0, v1, v2, v3);',\n\n      \"}\",\n\n      'vec3 transformed = vec3( position );',\n\n      'vec4 worldPosition = modelMatrix * jointMatrix * vec4( transformed, 1.0 );',\n      \n      \"gl_Position = projectionMatrix * viewMatrix * worldPosition;\",\n\n      '}',\n\n      ].join('\\n'),\n      \n      fragmentShader: [\n\n      THREE.ShaderChunk['common'],\n      THREE.ShaderChunk['packing'],\n      THREE.ShaderChunk['uv_pars_fragment'],\n      THREE.ShaderChunk['map_pars_fragment'],\n      THREE.ShaderChunk['alphamap_pars_fragment'],\n      THREE.ShaderChunk['logdepthbuf_pars_fragment'],\n      THREE.ShaderChunk['clipping_planes_pars_fragment'],\n\n      'void main() {',\n\n        THREE.ShaderChunk['clipping_planes_fragment'],\n\n        'vec4 diffuseColor = vec4( 1.0 );',\n\n        THREE.ShaderChunk['map_fragment'],\n        THREE.ShaderChunk['alphamap_fragment'],\n        THREE.ShaderChunk['alphatest_fragment'],\n\n        THREE.ShaderChunk['logdepthbuf_fragment'],\n\n        'gl_FragColor = packDepthToRGBA( gl_FragCoord.z );',\n\n      '}',\n      ].join('\\n'),\n      \n      uniforms: mat.uniforms\n  });\n};","\n'use strict'\n\nimport Joint from './Joint.js';\n\nimport skinDataToGeometry from './skinDataToGeometry.js'\n\nimport OimoWrapper from './LaserOimoWrapper.js'\n\nimport CannonController from './CannonController.js'\n\nimport JointMaterial from './JointMaterial.js'\n\nimport randomElement from './randomElement.js'\n\nimport getCustomDepthMaterial from './getCustomDepthMaterial.js'\n\nimport TWEEN from 'tween.js'\n\nimport JointTexture from './JointTexture.js'\n\n\n\nconst isSafari = Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0 || (function (p) { return p.toString() === \"[object SafariRemoteNotification]\"; })(!window['safari'] || safari.pushNotification);\n\nStartAudioContext(Tone.context, '#container', ()=>{\n  // if(isSafari)  alert('StartAudioContext')\n});\n\n\n\nvar randf = THREE.Math.randFloat;\n\nvar Sketch = function(options){\n\n  options = options || {};\n  \n  var debug = false;\n\n  console.log( '20161111_winding' );\n\n  var updateVertexPositions = false;\n\n  var elapsedTime = 0;\n\n  var container = options.container || $(\"#container\");\n\n  var globeRad = 10;\n  \n  var goalPos = new THREE.Vector3( 0, 0, 0 );\n  \n  var attenuation = 0.999;\n  \n  var hingeRange = 60;\n\n  var wigglyness = 1.5;\n  \n  var wigglySpeed = 6;\n  \n  var orig_wigglySpeed = wigglySpeed;\n  \n  var orig_wigglyness = wigglyness;\n  \n  var shadowRes = 2048;\n\n  var attraction = 0.5;\n\n\n  var gain = new Tone.Volume( 0 ).toMaster();\n  gain.set( 'volume',  0 );\n\n\n  // tone\n  var synth = new Tone.PolySynth(3, Tone.Synth).toMaster();\n  synth.volume.value = -10;\n  synth.set(\"detune\", -1200);\n\n  var dist = new Tone.Chorus(1, 10, 0.9).connect(gain);\n  var pingPong = new Tone.PingPongDelay(\"8n\", 0.3).connect(gain);\n\n  \n\n  var notes = ['A1','A2','A3','A4','C1','C2','C3','C4','E1','E2','E3','E4']\n  var playNote = () => {\n    duoSynth.triggerAttackRelease(randomElement(notes), \"16n\");\n  }\n\n\n  var audioEventFuncs = {\n    bass: () => {},\n    kick: () => {},\n    snare: () => {}\n  }\n\n\n  var bass = new Tone.MonoSynth({\n    \"volume\" : -10,\n    \"envelope\" : {\n      \"attack\" : 0.01,\n      \"decay\" : 0.3,\n      \"release\" : 2,\n    },\n    \"filterEnvelope\" : {\n      \"attack\" : 0.001,\n      \"decay\" : 0.01,\n      \"sustain\" : 0.5,\n      \"baseFrequency\" : 200,\n      \"octaves\" : 2.6\n    }\n  })\n  .connect(pingPong)\n  .connect(dist)\n\n\n  var bassPart = new Tone.Part(function(time, chord, note){\n    bass.triggerAttackRelease(chord, note || \"32n\", time);\n\n    switch (chord){\n      case 'B6':\n      case 'A6':\n      case 'F6':\n      case 'D6':\n        audioEventFuncs['snare']()\n        break;\n      default:\n        audioEventFuncs['bass']()\n        break;\n    }\n\n  }, [\n  [\"0:0\", \"G1\", '8n'], [\"0:2\", \"B6\", '8n'],\n  [\"1:0\", \"G2\", '8n'], [\"1:2\", \"B6\", '8n'],\n  [\"2:0\", \"G1\", '8n'], [\"2:2\", \"B6\", '8n'],\n  [\"3:0\", \"G2\", '8n'], [\"3:2\", \"B6\", '8n'],\n  [\"4:0\", \"B2\", '8n'], [\"4:2\", \"B6\", '8n'],\n  [\"5:0\", \"A2\", '8n'], [\"5:2\", \"A6\", '8n'],\n  [\"6:0\", \"F2\", '8n'], [\"6:2\", \"F6\", '8n'],\n  [\"7:0\", \"D2\", '8n'], [\"7:2\", \"D6\", '8n'],\n  ]).start();\n\n  bassPart.loop = true;\n  bassPart.loopEnd = \"8m\";\n  bassPart.humanize = true;\n  bassPart.probability = 0.66;\n\n\n  var kick = new Tone.MembraneSynth({\n    \"envelope\" : {\n      \"sustain\" : 0,\n      \"attack\" : 0.02,\n      \"decay\" : 0.8\n    },\n    \"octaves\" : 10\n  }).connect(gain);\n\n  var kickPart = new Tone.Part(function(time, note){\n    kick.triggerAttackRelease(note || \"C2\", \"8n\", time);\n    audioEventFuncs['kick']()\n  }, [\n  [\"0:0\"],\n  [\"1:0\"], \n  [\"2:0\"],\n  [\"3:0\"], \n  [\"4:0\"],\n  [\"4:2\", 'C1'],\n  [\"5:0\"], \n  [\"5:2\", 'C1'],\n  [\"6:0\"],\n  [\"6:2\", 'C1'],\n  [\"7:0\"], \n  [\"7:2\", 'C1'],\n  ]).start('0m');\n\n  kickPart.loop = true;\n  kickPart.loopEnd = \"8m\";\n  kickPart.humanize = true;\n  kickPart.probability = 0.5;\n\n\n  //set the transport \n  Tone.Transport.bpm.value = 240;\n  Tone.Transport.start(\"+0.1\");\n\n\n\n  // colors\n  var c0 = new THREE.Color(0xffffff);\n  var c1 = new THREE.Color(0xedff00);\n  var orig_c0 = c0.clone();\n  var orig_c1 = c1.clone();\n\n  // three\n  var view = new ThreeView(container);// boiler plate... couldn't this be passed in? then we could do a player...\n\n  var renderer = view.setupRenderer();\n\n  if(!isSafari) {\n    renderer.shadowMap.enabled = true;\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n  }\n  renderer.setClearColor(0x333333, 0.1)\n\n  var clock = new THREE.Clock();\n\n  var scene = new THREE.Scene();\n  scene.fog = new THREE.Fog( 0x000000, 60, 150 );\n\n  var camera = new THREE.PerspectiveCamera(60, view.aspect, 1, 1000);\n  camera.position.y = 10;\n  camera.position.z = 35;\n  camera.lookAt( new THREE.Vector3(camera.position.x, camera.position.y-20, 0) );\n\n\n  var controls = new THREE.OrbitControls( camera, renderer.domElement );\n  // controls.enabled = false;\n  controls.enableZoom = true;\n  controls.enableRotate = true;\n  controls.enablePan = true\n  controls.enableDamping = true;\n  controls.dampingFactor = 0.5;\n  controls.rotateSpeed = 0.5;\n  controls.minDistance = 10;\n  controls.maxDistance = 50;\n\n\n  \n  var makeSpot = () => {\n    var spot = new THREE.SpotLight();\n\n    spot.castShadow = true;\n    spot.shadow.mapSize.width = shadowRes;\n    spot.shadow.mapSize.height = shadowRes;\n    spot.shadow.camera.near = 0.1;\n    spot.shadow.camera.far = 100;\n    spot.shadow.camera.fov = 10;\n\n    // spot.penumbra = 1\n    // spot.shadow.bias = 0.000001;\n\n    return spot\n  }\n\n  var spot = makeSpot();\n  spot.color.set(0xBBFFEE).multiplyScalar( 0.66 );\n  spot.position.lerp(camera.position, 0.5);\n  spot.position.y += 10;\n  spot.lookAt(new THREE.Vector3( 0, 0, 0 ));\n  scene.add(spot);\n\n\n  var hemi = new THREE.HemisphereLight( 0x6688BB, 0x181844, 1 );\n  scene.add( hemi );\n\n\n\n  let box = new THREE.Mesh(new THREE.BoxGeometry(10,10,10), new THREE.MeshBasicMaterial({\n    color: 'white',\n    wireframe: true,\n    side: 2\n  }))\n\n\n\n  var cc = CannonController({\n    gravity: new CANNON.Vec3(0,0,0),\n    maxSubSteps: isSafari ? 1 : 2\n  });\n\n\n  var debugSphere = new THREE.Mesh(new THREE.SphereGeometry(1), new THREE.MeshBasicMaterial({\n    color: 'red',\n    wireframe: true\n  }))\n  debugSphere.visible = debug;\n  debugSphere.position.z = 100;\n  debugSphere.body = cc.addSphere(1, {mass: 0});\n  scene.add(debugSphere)\n\n\n\n  var dragPlane = new THREE.Mesh(new THREE.PlaneGeometry( 300, 300, 10, 10), new THREE.MeshBasicMaterial( {\n    color: 'magenta',\n    wireframe: true\n  } ));\n  dragPlane.visible = false;\n\n  scene.add(dragPlane)\n\n\n\n\n  var dataTex = new THREE.DataTexture( new Uint8Array([255,0,255, 0,255,255]), 2, 1, THREE.RGBFormat)\n  var updateDataTex = ()=>{\n\n    let colorVals = c0.toArray().concat(c1.toArray());\n\n    for(var i=0; i<colorVals.length; i++) {\n      dataTex.image.data[i] = colorVals[i] * 255;\n    }\n    dataTex.needsUpdate = true;\n  }\n  updateDataTex();\n\n\n  var skinLoader = new THREE.XHRLoader();\n  skinLoader.setResponseType('json');\n  \n\n  // debug meshes\n  let cube = new THREE.Mesh(new THREE.BoxGeometry(1,1,1), new THREE.MeshBasicMaterial({\n    color: 'cyan',\n    wireframe: true\n  }));\n\n  let jointCube = new THREE.Mesh(cube.geometry, new THREE.MeshBasicMaterial( {\n    color: 'red',\n    wireframe: true\n  } ) );\n  jointCube.scale.multiplyScalar(2);\n\n  var skins = [];\n  var intersectables = [];\n\n  var createSkin = (json, geometry) => {\n    var skin = {\n      skinObj: new THREE.Object3D(),\n      raycastIntersects: [],\n      rigidBodies: [],\n      constraints: [],\n      loaded: false,\n      joints: [],\n      geometry: null,\n      material: null,\n      mesh: null,\n      jointTexture: null\n    }\n\n    var skinObj = skin.skinObj;\n    scene.add(skinObj);\n\n    // create the joints\n    let jointMap = {}\n\n    json['joints'].forEach( function( j ){\n      \n      let joint = new Joint({\n        name: j.name,\n        transform: new THREE.Matrix4().fromArray(j['transform']),\n        rigidBody: j.rigidBody\n      })\n\n      skin.joints.push(joint);\n\n      jointMap[j.name] = joint;\n\n      // DEBUG\n      if(debug)  joint.add(jointCube.clone());\n    });\n\n\n    // create the rigid bodies\n    for(let i in json['rigidBodies']) {\n\n      let data = json['rigidBodies'][i];\n      \n      let b = new THREE.Object3D();\n      b.name = i\n      b.applyMatrix(new THREE.Matrix4().fromArray(data['transform']))\n      b.updateMatrixWorld(true);\n      skinObj.add(b)\n      skin.rigidBodies.push(b)\n      \n      let inv = new THREE.Matrix4().getInverse(b.matrixWorld)\n\n      data.joints.forEach((j)=>{\n        jointMap[j].applyMatrix(inv);\n        b.add(jointMap[j])\n      })\n\n      // debug rigid body bounds\n      let c = cube.clone();\n      c.scale.multiply( new THREE.Vector3().fromArray(data['extents']) );\n      c.visible = debug;\n      b.add(c);\n\n\n      b.body = cc.addBoxMesh( c, {\n        position: b.position,\n        mass: data.mass,\n        restitution: data.restitution\n      });\n\n\n      b.body.skin = skin;\n\n\n      c.body = b.body;\n      skin.raycastIntersects.push(c)\n    }\n\n\n    // create the constraints\n    for(var i in json['constraints']) {\n\n      let c = json[\"constraints\"][i]\n      let a = skinObj.getObjectByName(c['rigidBodyA']);\n      let b = skinObj.getObjectByName(c['rigidBodyB'])\n      \n      let dataA = json['rigidBodies'][c['rigidBodyA']]\n      let dataB = json['rigidBodies'][c['rigidBodyB']]\n      \n      let constraintPos = new THREE.Vector3().fromArray(c['translate']);\n      \n      // local axis in rigid bodies\n      let invA = new THREE.Matrix4().getInverse(a.matrixWorld)\n      let invB = new THREE.Matrix4().getInverse(b.matrixWorld)\n\n      let pointInA = constraintPos.clone().applyMatrix4(invA);\n      let pointInB = constraintPos.clone().applyMatrix4(invB);\n\n      let constraint = cc.addConeConstraint( \n\n        a.body,\n        pointInA,\n        CANNON.Vec3.UNIT_Y,\n        \n        b.body,\n        pointInB,\n        CANNON.Vec3.UNIT_Y,\n\n        Infinity);\n\n\n      constraint.angle = .5;\n      constraint.twistAngle = 1;\n\n      skin.constraints.push(constraint);\n    }\n\n\n    // set the initial joint offsets\n    skinObj.updateMatrixWorld(true);\n\n    skin.joints.forEach( j => {\n      j.setOffset();\n    });\n\n\n    // put together the mesh\n    let jointTransforms = skin.joints.map(j => {\n      return j.transform\n    })\n\n\n    let jointTexture = new JointTexture(jointTransforms);\n    var jointMaterial = new JointMaterial(jointTransforms);\n\n    jointMaterial.uniforms.map.value = dataTex;\n    jointMaterial.uniforms.jointTexture.value = jointTexture.texture;\n    jointMaterial.uniforms.jointTextureDim.value.set( jointTexture.texture.image.width, jointTexture.texture.image.height)\n\n    \n    let mesh = new THREE.Mesh(geometry, jointMaterial);\n    mesh.castShadow = true;\n    mesh.receiveShadow = true;\n    mesh.customDepthMaterial = getCustomDepthMaterial(jointMaterial, jointTransforms)\n\n\n    skinObj.add(mesh);\n    skin.geometry = geometry;\n    skin.material = jointMaterial;\n    skin.material = jointMaterial;\n    skin.mesh = mesh;\n    skin.jointTexture = jointTexture;\n\n    skin.loaded = true;\n\n    intersectables = intersectables.concat(skin.raycastIntersects);\n\n    return skin;\n  }\n\n\n  skinLoader.load('assets/mesh.json', json => {\n\n    let geometry = skinDataToGeometry(json);\n\n    let count = 3;\n\n    for (var i=0; i<count; i++) {\n\n      let skin = createSkin(json, geometry);\n      skins.push(skin);  \n    }\n\n    skins[0].hitValAttenuation = 0.9;\n    audioEventFuncs['bass'] = () =>{\n      \n      skins[0].mesh.material.uniforms.hitVal.value = 1.5;\n      \n      if(skins[0].hitTween){\n      \n        skins[0].hitTween.start()\n      \n      } else {\n\n        skins[0].hitTween = new TWEEN.Tween(skins[0].mesh.material.uniforms.hitVal)\n        .easing(TWEEN.Easing.Cubic.Out)\n        .to({value: 0}, 1000)\n        .start() \n      }\n    }\n\n    skins[1].mesh.material.uniforms.hitColor.value.set(0xFFFFFF); //0x22BBFF\n    skins[1].hitValAttenuation = 0.9;\n    audioEventFuncs['kick'] = () =>{\n      skins[1].mesh.material.uniforms.hitVal.value = 1.5;\n\n      if(skins[1].hitTween){\n      \n        skins[1].hitTween.start()\n      \n      } else {\n\n        skins[1].hitTween = new TWEEN.Tween(skins[1].mesh.material.uniforms.hitVal)\n        .easing(TWEEN.Easing.Cubic.Out)\n        .to({value: 0}, 750)\n        .start() \n      }\n    }\n\n    skins[2].mesh.material.uniforms.hitColor.value.set(0x22AAFF);\n    skins[2].hitValAttenuation = 0.9;\n    audioEventFuncs['snare'] = () =>{\n      \n      skins[2].mesh.material.uniforms.hitVal.value = 2;\n\n      if(skins[2].hitTween){\n      \n        skins[2].hitTween.start()\n      \n      } else {\n\n        skins[2].hitTween = new TWEEN.Tween(skins[2].mesh.material.uniforms.hitVal)\n        .easing(TWEEN.Easing.Cubic.Out)\n        .to({value: 0}, 500)\n        .start() \n      }\n\n\n    }\n    \n  });\n\n\n  var updateSkin = skin => {\n\n    if (skin.loaded) {\n\n\n      skin.jointTexture.update();\n\n      // if(skin.mesh) {\n      //   skin.mesh.material.uniforms.hitVal.value *= skin.hitValAttenuation;\n      // }\n\n\n\n      let delta = new THREE.Vector3();\n\n      let hitVal = skin.mesh.material.uniforms.hitVal.value;\n      let scl = 100 * hitVal;\n      skin.constraints.forEach((c, i)=>{\n\n        let b1 = skin.constraints[i].bodyA\n        let b2 = skin.constraints[i].bodyB\n\n        if (elapsedTime < 1 && i === 1) {\n          // console.log( b2.velocity );\n        }\n\n\n        delta.copy(b1.position);\n        delta.sub(b2.position);\n\n        delta.normalize();\n        delta.multiplyScalar( scl );\n\n        delta.lerp(b2.velocity, 0.5);\n\n        b2.velocity.copy(delta)\n      })\n\n\n      skin.joints.forEach( j => {\n        j.updateTransform();\n      });\n\n      // rigid bodiy transforms\n      skin.rigidBodies.forEach( (b, i)=>{\n\n        if(b.body){\n\n          b.body.velocity.x *= attenuation;\n          b.body.velocity.y *= attenuation;\n          b.body.velocity.z *= attenuation; \n          \n          b.body.angularVelocity.x *= attenuation;\n          b.body.angularVelocity.y *= attenuation;\n          b.body.angularVelocity.z *= attenuation;\n\n          b.body.velocity.x -= b.body.position.x * attraction;\n          b.body.velocity.y -= b.body.position.y * attraction;\n          b.body.velocity.z -= b.body.position.z * attraction;\n          \n          b.position.copy(b.body.position);\n          b.quaternion.copy(b.body.quaternion);\n        }\n\n      });\n    }\n\n    if(updateVertexPositions) updateSkinVertices(skin);\n\n  }\n\n  view.update = function(){\n\n    if(Tone.context.state && Tone.context.state === \"suspended\") {\n      Tone.context.resume().then(function() {\n        console.log(\"AudioContext resumed!\");\n        // fire your callback here\n      });\n    }\n\n    elapsedTime = clock.getElapsedTime();\n    \n    TWEEN.update();\n\n    // oc.update();\n\n    cc.update(elapsedTime);\n\n    controls.update();\n    \n    skins.forEach( function( skin ){\n    \n      updateSkin(skin);\n    \n    });\n\n\n  };\n\n\n  view.draw = function(){\n\n    renderer.render(scene, camera, null, true);\n\n  };\n\n\n  view.onResize = function(){\n\n    camera.aspect = view.aspect;\n    camera.updateProjectionMatrix();\n\n  };\n\n\n  var raycaster = new THREE.Raycaster();\n  var mouse = new THREE.Vector2();\n  var mousedown = false;\n  var grabbed = false;\n  var draggedBody, dragConstraint;\n\n\n\n  var onPress = e => {\n\n    mousedown = true;\n\n    if(e.type === 'touchmove') {\n      mouse.x = ( e.touches[0].pageX / window.innerWidth ) * 2 - 1;\n      mouse.y = - ( e.touches[0].pageY / window.innerHeight ) * 2 + 1;\n    } else {\n      mouse.x = ( e.pageX / window.innerWidth ) * 2 - 1;\n      mouse.y = - ( e.pageY / window.innerHeight ) * 2 + 1;\n    }\n\n    raycaster.setFromCamera( mouse, camera );\n\n    intersectables.forEach( function( m ){\n      m.visible = true;\n    });\n    \n    let intersects = raycaster.intersectObjects( intersectables );\n    \n    intersectables.forEach( function( m ){\n      m.visible = debug;\n    });\n\n    if(intersects.length){\n\n      grabbed = true;\n\n      if(e.type === 'touchstart')  controls.enabled = false;\n      controls.enableRotate = false;\n\n      let skin = intersects[0].object.body.skin;\n\n      let p = intersects[0].point;\n\n      dragPlane.position.copy(p);\n      dragPlane.lookAt(camera.position);\n\n      debugSphere.position.copy(p)\n      debugSphere.body.position.copy(debugSphere.position);\n\n      dragConstraint = cc.addPointConstraint(\n        intersects[0].object.body,\n        new THREE.Vector3( 0, 0, 0 ),\n        debugSphere.body,\n        new THREE.Vector3( 0, 0, 0 ));\n    }\n  }\n\n  var onRelease = e => {\n\n    if(grabbed){\n      cc.removeConstraint(dragConstraint)\n    }\n\n    if(!controls.enableRotate) {\n      controls.enabled = true;\n      controls.enableRotate = true;\n    }\n    \n    mousedown = false;\n    \n    grabbed = false;\n\n    dragPlane.visible = false;\n  }\n\n  var onDrag = e => {\n\n    if(grabbed){\n\n      if(e.type === 'touchmove') {\n        mouse.x = ( e.touches[0].pageX / window.innerWidth ) * 2 - 1;\n        mouse.y = - ( e.touches[0].pageY / window.innerHeight ) * 2 + 1;\n      } else {\n        mouse.x = ( e.pageX / window.innerWidth ) * 2 - 1;\n        mouse.y = - ( e.pageY / window.innerHeight ) * 2 + 1;\n      }\n\n      raycaster.setFromCamera( mouse, camera );\n\n      dragPlane.visible = true;\n      let intersects = raycaster.intersectObject( dragPlane );\n      dragPlane.visible = false;\n\n\n      if(intersects.length){\n\n        let p = intersects[0].point;\n\n        debugSphere.position.copy(p)\n        debugSphere.body.position.copy(p);\n      }\n    }\n\n  }\n\n\n  $(window).on('mousedown', onPress)\n  $(window).on('mouseup', onRelease)\n  $(window).on('mousemove', onDrag)\n\n  container.on('touchstart', onPress);\n  container.on('touchend', onRelease);\n  container.on('touchmove', onDrag);\n\n\n  return {\n    begin: function(){\n      view.begin();\n    }\n  };\n\n};\n\n\n\nwindow.onload = () => {\n\n  var sketch = new Sketch();\n\n  sketch.begin();\n\n};\n\n\n","\n\n/**\n * returns a random element from an array or object\n * @param  {Array|Object} obj\n * @return {object}\n */\nmodule.exports = function(obj) {\n\n  if (Array.isArray(obj)) {\n\n    return obj[Math.floor(Math.random() * obj.length)];\n\n  } else if (obj instanceof Object) {\n\n    return obj[randElement(Object.keys[obj])];\n\n  }\n\n  return obj;\n};\n","// SkinDataToGeometry.js\n\n\nmodule.exports = json => {\n\n  var faces = json['meshData']['faces']\n  var v = json['meshData']['position'];\n  var n = json['meshData']['normal'];\n  var uv = json['meshData']['uv'][Object.keys(json['meshData']['uv'])[0]];\n  var sw = json['skinWeights'];\n  var si = json['skinIndices'];\n\n  var positions = [];\n  var normals = [];\n  var uvs = [];\n\n  var jointWeights = [];\n  var jointIndices = [];\n\n  var addPos = p => {\n    positions.push(p[0], p[1], p[2])\n  }\n\n  var addNorm = n => {\n    normals.push(n[0], n[1], n[2])\n  }\n\n  var addUV = uv => {\n    uvs.push(uv[0], uv[1])\n  }\n\n  var addJointWeights = jw => {\n    jointWeights.push(jw[0] || 0, jw[1] || 0, jw[2] || 0)\n  }\n\n  var addJointIndices = ji => {\n    jointIndices.push(ji[0] || 0, ji[1] || 0, ji[2] || 0)\n  }\n\n  // interate through the faces\n  var v0, v1, v2, i, j;\n  faces.forEach( function( f ){\n    \n    // iterate through the face triangles\n    let norm = [\n    n[ f[1][0] ],\n    n[ f[1][1] ],\n    n[ f[1][2] ]\n    ]\n    for(i=1, j=2; j<f[0].length; i++, j++) {\n\n      // positions\n      addPos( v[ f[0][0] ] );\n      addPos( v[ f[0][i] ] );\n      addPos( v[ f[0][j] ] );\n\n      // normals\n      addNorm(norm[0]);// n[ f[1][0] ] );\n      addNorm(norm[1]);// n[ f[1][i] ] );\n      addNorm(norm[2]);// n[ f[1][j] ] );\n\n      // uvs\n      addUV( uv[ f[2][0] ] );\n      addUV( uv[ f[2][i] ] );\n      addUV( uv[ f[2][j] ] );\n\n      // joint weights\n      addJointWeights( sw[ f[0][0] ] );\n      addJointWeights( sw[ f[0][i] ] );\n      addJointWeights( sw[ f[0][j] ] );\n\n      // joint indices\n      addJointIndices( si[ f[0][0] ] );\n      addJointIndices( si[ f[0][i] ] );\n      addJointIndices( si[ f[0][j] ] );\n\n    }\n  \n  });\n\n  // create the Buffer mesh\n  var geometry = new THREE.BufferGeometry();\n\n  geometry.addAttribute( 'position', new THREE.BufferAttribute( new Float32Array(positions), 3 ) );\n  geometry.addAttribute( 'orig_position', new THREE.BufferAttribute( new Float32Array(positions), 3 ) );\n  geometry.addAttribute( 'orgPos', new THREE.BufferAttribute( new Float32Array(positions), 3 ) );\n  geometry.addAttribute( 'normal', new THREE.BufferAttribute( new Float32Array(normals), 3 ) );\n  geometry.addAttribute( 'jointWeights', new THREE.BufferAttribute( new Float32Array(jointWeights), 3 ) );\n  geometry.addAttribute( 'jointIndices', new THREE.BufferAttribute( new Float32Array(jointIndices), 3 ) );\n  geometry.addAttribute( 'uv', new THREE.BufferAttribute( new Float32Array(uvs), 2 ) );\n\n  return geometry;\n}"]}
